function ignore(){}function id(n){return n}function fst(n){return n[0]}function snd(n){return n[1]}function trd(n){return n[2]}IntelliFactory={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i in n)t[i]=n[i];return t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return IntelliFactory.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:IntelliFactory.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};IntelliFactory.Runtime.OnLoad(function(){self.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});console||(console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore});
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(this);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9;a=self;b=a.FSharpSPA=a.FSharpSPA||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Operators=d.Operators||{};f=d.Obj=d.Obj||{};g=d.UI=d.UI||{};h=g.Templating=g.Templating||{};i=h.Runtime=h.Runtime||{};j=i.Server=i.Server||{};k=j.TemplateInstance=j.TemplateInstance||{};l=d.Arrays=d.Arrays||{};m=j.ProviderBuilder=j.ProviderBuilder||{};n=d.Unchecked=d.Unchecked||{};o=a.FSharpSPA_Templates=a.FSharpSPA_Templates||{};p=a.StartupCode$FSharpSPA$Client=a.StartupCode$FSharpSPA$Client||{};q=a.System=a.System||{};r=q.Guid=q.Guid||{};s=d.Collections=d.Collections||{};t=s.List=s.List||{};u=j.Handler=j.Handler||{};v=g.Client=g.Client||{};w=v.Templates=v.Templates||{};x=g.Doc=g.Doc||{};y=d.JavaScript=d.JavaScript||{};z=y.Pervasives=y.Pervasives||{};A=s.Dictionary=s.Dictionary||{};B=b.Solver=b.Solver||{};C=b.Year2020Common=b.Year2020Common||{};D=b.Year2020Day3=b.Year2020Day3||{};E=b.Year2020Day4=b.Year2020Day4||{};F=b.Year2020Day5=b.Year2020Day5||{};G=g.Var$1=g.Var$1||{};H=s.HashSet=s.HashSet||{};I=d.Seq=d.Seq||{};J=j.TemplateInitializer=j.TemplateInitializer||{};K=a.EventTarget;L=a.Node;M=y.JS=y.JS||{};N=g.View=g.View||{};O=d.Numeric=d.Numeric||{};P=a.Object;Q=g.AttrProxy=g.AttrProxy||{};R=g.Var=g.Var||{};S=g.CheckedInput=g.CheckedInput||{};T=g.HtmlModule=g.HtmlModule||{};U=T.attr=T.attr||{};V=B.Status=B.Status||{};W=B.Cmd=B.Cmd||{};X=d.Strings=d.Strings||{};Y=D.State=D.State||{};Z=D.Move=D.Move||{};_0=d.List=d.List||{};_1=g.ConcreteVar=g.ConcreteVar||{};_2=g.Snap=g.Snap||{};_3=s.DictionaryUtil=s.DictionaryUtil||{};_4=d.Enumerator=d.Enumerator||{};_5=_4.T=_4.T||{};_6=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};_7=a.WindowOrWorkerGlobalScope;_8=g.Docs=g.Docs||{};_9=g.DocElemNode=g.DocElemNode||{};_=a.CharacterData;$=g.DomUtility=g.DomUtility||{};ba=g.Array=g.Array||{};bb=a.StartupCode$FSharpSPA$Year2020Day3=a.StartupCode$FSharpSPA$Year2020Day3||{};bc=C.State=C.State||{};bd=_0.T=_0.T||{};be=a.StartupCode$FSharpSPA$Year2020Day4=a.StartupCode$FSharpSPA$Year2020Day4||{};bf=a.Error;bg=d.MatchFailureException=d.MatchFailureException||{};bh=a.StartupCode$FSharpSPA$Year2020Day5=a.StartupCode$FSharpSPA$Year2020Day5||{};bi=g.Abbrev=g.Abbrev||{};bj=bi.Fresh=bi.Fresh||{};bk=g.Elt=g.Elt||{};bl=w.Prepare=w.Prepare||{};bm=d.Slice=d.Slice||{};bn=s.KeyCollection=s.KeyCollection||{};bo=g.An=g.An||{};bp=v.Settings=v.Settings||{};bq=bi.Mailbox=bi.Mailbox||{};br=v.Attrs=v.Attrs||{};bs=br.Dyn=br.Dyn||{};bt=g.Attrs=g.Attrs||{};bu=a.StartupCode$FSharpSPA$Year2020Common=a.StartupCode$FSharpSPA$Year2020Common||{};bv=g.AttrModule=g.AttrModule||{};bw=g.Updates=g.Updates||{};bx=s.ValueCollection=s.ValueCollection||{};by=v.Docs=v.Docs||{};bz=by.RunState=by.RunState||{};bA=by.NodeSet=by.NodeSet||{};bB=d.Concurrency=d.Concurrency||{};bC=g.Anims=g.Anims||{};bD=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bE=s.HashSetUtil=s.HashSetUtil||{};bF=d.FormatException=d.FormatException||{};bG=d.OverflowException=d.OverflowException||{};bH=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};bI=g.BindVar=g.BindVar||{};bJ=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bK=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bL=g.AppendList=g.AppendList||{};bM=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bN=g.DynamicAttrNode=g.DynamicAttrNode||{};bO=bB.Scheduler=bB.Scheduler||{};bP=g.Easing=g.Easing||{};bQ=bB.AsyncBody=bB.AsyncBody||{};bR=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bS=bB.CT=bB.CT||{};bT=bi.HashSet=bi.HashSet||{};bU=g.String=g.String||{};bV=d.CancellationTokenSource=d.CancellationTokenSource||{};bW=by.DomNodes=by.DomNodes||{};bX=d.Char=d.Char||{};bY=d.OperationCanceledException=d.OperationCanceledException||{};bZ=d.Lazy=d.Lazy||{};b0=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};b1=d.Queue=d.Queue||{};b2=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};b3=b2.LazyRecord=b2.LazyRecord||{};b4=a.jQuery;b5=a.console;b6=a.IntelliFactory;b7=b6&&b6.Runtime;b8=a.Math;b9=a.Date;c.Main=function(){var b_,b$,ca,cb,cc;b_=(b$=(ca=new m.New$1(),(ca.h.push({$:0,$0:"quicktest",$1:c.AoC()}),ca)),(cb=u.CompleteHoles(b$.k,b$.h,[]),(cc=new k.New(cb[1],o.aoc2020(cb[0])),b$.i=cc,cc))).get_Doc();w.LoadLocalTemplates("");x.RunById("aoc",b_);};c.AoC=function(){p.$cctor();return p.AoC;};c.produceSolution=function(b_,b$,ca,cb,cc,cd,ce,cf){return x.Element("div",[],[x.Element("p",[],[x.TextNode(ca)]),x.Element("a",[Q.Create("href",cb),Q.Create("target","_blank")],[x.TextNode(cc)]),x.Element("br",[],[]),x.Button(cd,[],function(){b4.ajax(ce,{beforeSend:function(cg){return cg.setRequestHeader("crossDomain","");},crossDomain:true,success:function(cg){b4("#"+b$).val(cg);return b_.Set({$:1,$0:cg});}}).done(function(){return b5.log("Done");});}),x.Element("br",[],[]),x.Element("textarea",[Q.Create("id",b$),Q.Create("style","height:100px")],[]),x.Element("br",[],[]),x.BindView(function(cg){return cg!=null&&cg.$==1?x.Concat([x.Button("Solve it!",[],function(){c.Solve(cf,"solved"+b$,a.String(b4("#"+b$).val()));}),x.Element("br",[],[]),x.Element("label",[],[x.TextNode("Solution")]),x.Element("input",[Q.Create("id","solved"+b$)],[])]):x.get_Empty();},b_.get_View())]);};c.Solve=function(b_,b$,ca){var cb;b4("#"+b$).val("");cb=a.String(b_(ca));b4("#"+b$).val(cb);};e.FailWith=function(b_){throw new bf(b_);};e.range=function(b_,b$){var ca;ca=1+b$-b_;return ca<=0?[]:I.init(ca,function(cb){return cb+b_;});};e.KeyValue=function(b_){return[b_.K,b_.V];};f=d.Obj=b7.Class({Equals:function(b_){return this===b_;},GetHashCode:function(){return -1;}},null,f);f.New=b7.Ctor(function(){},f);k=j.TemplateInstance=b7.Class({get_Doc:function(){return this.doc;}},f,k);k.New=b7.Ctor(function(b_,b$){f.New.call(this);this.doc=b$;this.allVars=b_.$==0?b_.$0:e.FailWith("Should not happen");},k);l.get=function(b_,b$){l.checkBounds(b_,b$);return b_[b$];};l.checkBounds=function(b_,b$){if(b$<0||b$>=b_.length)e.FailWith("Index was outside the bounds of the array.");};l.length=function(b_){return b_.dims===2?b_.length*b_.length:b_.length;};l.set=function(b_,b$,ca){l.checkBounds(b_,b$);b_[b$]=ca;};m=j.ProviderBuilder=b7.Class({},f,m);m.New$1=b7.Ctor(function(){var b_;f.New.call(this);this.i=null;this.k=(b_=r.NewGuid(),a.String(b_));this.h=[];b7.SetOptional(this,"s",null);},m);n.Equals=function(b_,b$){var ca,cb,cc,cd;if(b_===b$)return true;else{ca=typeof b_;if(ca=="object"){if(b_===null||b_===void 0||b$===null||b$===void 0)return false;else if("Equals"in b_)return b_.Equals(b$);else if(b_ instanceof a.Array&&b$ instanceof a.Array)return n.arrayEquals(b_,b$);else if(b_ instanceof a.Date&&b$ instanceof a.Date)return n.dateEquals(b_,b$);else{cb=[true];for(var ce in b_)if(function(cf){cb[0]=!b_.hasOwnProperty(cf)||b$.hasOwnProperty(cf)&&n.Equals(b_[cf],b$[cf]);return!cb[0];}(ce))break;if(cb[0]){for(var cf in b$)if(function(cg){cb[0]=!b$.hasOwnProperty(cg)||b_.hasOwnProperty(cg);return!cb[0];}(cf))break;}return cb[0];}}else return ca=="function"&&("$Func"in b_?b_.$Func===b$.$Func&&b_.$Target===b$.$Target:"$Invokes"in b_&&"$Invokes"in b$&&n.arrayEquals(b_.$Invokes,b$.$Invokes));}};n.arrayEquals=function(b_,b$){var ca,cb;if(l.length(b_)===l.length(b$)){ca=true;cb=0;while(ca&&cb<l.length(b_)){!n.Equals(l.get(b_,cb),l.get(b$,cb))?ca=false:void 0;cb=cb+1;}return ca;}else return false;};n.dateEquals=function(b_,b$){return b_.getTime()===b$.getTime();};n.Compare=function(b_,b$){var ca,cb,cc,cd,ce,cf;if(b_===b$)return 0;else{cb=typeof b_;switch(cb=="function"?1:cb=="boolean"?2:cb=="number"?2:cb=="string"?2:cb=="object"?3:0){case 0:return typeof b$=="undefined"?0:-1;case 1:return e.FailWith("Cannot compare function values.");case 2:return b_<b$?-1:1;case 3:if(b_===null)cc=-1;else if(b$===null)cc=1;else if("CompareTo"in b_)cc=b_.CompareTo(b$);else if("CompareTo0"in b_)cc=b_.CompareTo0(b$);else if(b_ instanceof a.Array&&b$ instanceof a.Array)cc=n.compareArrays(b_,b$);else if(b_ instanceof a.Date&&b$ instanceof a.Date)cc=n.compareDates(b_,b$);else{cd=[0];for(var cg in b_)if(function(ch){return!b_.hasOwnProperty(ch)?false:!b$.hasOwnProperty(ch)?(cd[0]=1,true):(cd[0]=n.Compare(b_[ch],b$[ch]),cd[0]!==0);}(cg))break;if(cd[0]===0){for(var ch in b$)if(function(ci){return!b$.hasOwnProperty(ci)?false:!b_.hasOwnProperty(ci)&&(cd[0]=-1,true);}(ch))break;}cc=cd[0];}return cc;}}};n.Hash=function(b_){var b$;b$=typeof b_;return b$=="function"?0:b$=="boolean"?b_?1:0:b$=="number"?b_:b$=="string"?n.hashString(b_):b$=="object"?b_==null?0:b_ instanceof a.Array?n.hashArray(b_):n.hashObject(b_):0;};n.compareArrays=function(b_,b$){var ca,cb;if(l.length(b_)<l.length(b$))return -1;else if(l.length(b_)>l.length(b$))return 1;else{ca=0;cb=0;while(ca===0&&cb<l.length(b_)){ca=n.Compare(l.get(b_,cb),l.get(b$,cb));cb=cb+1;}return ca;}};n.compareDates=function(b_,b$){return n.Compare(b_.getTime(),b$.getTime());};n.hashString=function(b_){var b$,ca,cb;if(b_===null)return 0;else{b$=5381;for(ca=0,cb=b_.length-1;ca<=cb;ca++)b$=n.hashMix(b$,b_[ca].charCodeAt());return b$;}};n.hashArray=function(b_){var b$,ca,cb;b$=-34948909;for(ca=0,cb=l.length(b_)-1;ca<=cb;ca++)b$=n.hashMix(b$,n.Hash(l.get(b_,ca)));return b$;};n.hashObject=function(b_){var b$,ca;if("GetHashCode"in b_)return b_.GetHashCode();else{b$=[0];for(var cb in b_)if(function(cc){b$[0]=n.hashMix(n.hashMix(b$[0],n.hashString(cc)),n.Hash(b_[cc]));return false;}(cb))break;return b$[0];}};n.hashMix=function(b_,b$){return(b_<<5)+b_+b$;};o.aoc2020=function(b_){w.LoadLocalTemplates("index");return b_?w.NamedTemplate("index",{$:1,$0:"aoc2020"},b_):void 0;};p.$cctor=function(){var b_,b$,ca,cb,cc,cd,ce;p.$cctor=a.ignore;p.AoC=(b_=G.Create$1(null),(b$=G.Create$1(null),(ca=G.Create$1(null),(cb=G.Create$1(null),(cc=G.Create$1(null),(cd=G.Create$1(null),(ce=G.Create$1(null),x.Element("div",[],[x.Element("h2",[],[x.TextNode("year 2019")]),c.produceSolution(b_,"inputText2019_02_01","day 2 part 1","https://adventofcode.com/2019/day/2","visit advent of code 2019 day 2","Grab input day 2 part 1 2019","Content/input_2019_02.txt",B.Solve),x.Element("h2",[],[x.TextNode("year 2020")]),c.produceSolution(b$,"inputText2020_03_01","day 3 part 1","https://adventofcode.com/2020/day/3","visit advent of code 2020 day 3","Grab input day 3 part 1 2020","Content/input_2020_03.txt",function(cf){return D.phase1(l.map(C.cleanLine,l.filter(function(cg){return X.Trim(cg).length>0;},X.SplitChars(cf,["\n"],0))));}),c.produceSolution(ca,"inputText2020_03_02","day 3 part 2","https://adventofcode.com/2020/day/3","visit advent of code 2020 day 3","Grab input day 3 part 2 2020","Content/input_2020_03.txt",function(cf){return D.phase2(l.map(C.cleanLine,l.filter(function(cg){return X.Trim(cg).length>0;},X.SplitChars(cf,["\n"],0))));}),c.produceSolution(cb,"inputText2020_04_01","day 4 part 1","https://adventofcode.com/2020/day/4","visit advent of code 2020 day 4","Grab input day 4 part 1 2020","Content/input_2020_04.txt",function(cf){return E.phase1(l.map(C.cleanLine,l.map(function(cg){return X.Replace(cg,"\n"," ");},X.SplitStrings(cf,["\n\n"],0))));}),c.produceSolution(cc,"inputText2020_04_02","day 4 part 2","https://adventofcode.com/2020/day/4","visit advent of code 2020 day 4","Grab input day 4 part 2 2020","Content/input_2020_04.txt",function(cf){return E.phase2(l.map(C.cleanLine,l.map(function(cg){return X.Replace(cg,"\n"," ");},X.SplitStrings(cf,["\n\n"],0))));}),c.produceSolution(cd,"inputText2020_05_01","day 5 part 1","https://adventofcode.com/2020/day/5","visit advent of code 2020 day 5","Grab input day 5 part 1 2020","Content/input_2020_05.txt",function(cf){return F.phase1(l.map(C.cleanLine,l.filter(function(cg){return X.Trim(cg).length>0;},X.SplitChars(cf,["\n"],0))));}),c.produceSolution(ce,"inputText2020_05_02","day 5 part 2","https://adventofcode.com/2020/day/5","visit advent of code 2020 day 5","Grab input day 5 part 2 2020","Content/input_2020_05.txt",function(cf){return F.phase2(l.map(C.cleanLine,l.filter(function(cg){return X.Trim(cg).length>0;},X.SplitChars(cf,["\n"],0))));})]))))))));};r.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(b_){var b$,ca;b$=b8.random()*16|0;ca=b_=="x"?b$:b$&3|8;return ca.toString(16);});};t=s.List=b7.Class({GetEnumerator:function(){return _4.Get(this);},GetEnumerator0:function(){return _4.Get0(this);}},null,t);u.CompleteHoles=function(b_,b$,ca){var cc,cd,ce,cf,cg;function cb(ch,ci){var cj;return cd.Contains(ch)?null:(cj=ci===0?J.GetOrAddHoleFor(b_,ch,function(){return{$:8,$0:ch,$1:G.Create$1("")};}):ci===1?J.GetOrAddHoleFor(b_,ch,function(){return{$:13,$0:ch,$1:G.Create$1(0)};}):ci===2?J.GetOrAddHoleFor(b_,ch,function(){return{$:9,$0:ch,$1:G.Create$1(false)};}):e.FailWith("Invalid value type"),(cc.set_Item(ch,cj),{$:1,$0:cj}));}cc=new A.New$5();cd=new H.New$3();ce=_4.Get(b$);try{while(ce.MoveNext()){cf=ce.Current();cg=cf.$0;cd.Add(cg);cc.set_Item(cg,cf);}}finally{if(typeof ce=="object"&&"Dispose"in ce)ce.Dispose();}return[I.append(b$,l.choose(function(ch){return cb(ch[0],ch[1]);},ca)),{$:0,$0:cc}];};w.LoadLocalTemplates=function(b_){!w.LocalTemplatesLoaded()?(w.set_LocalTemplatesLoaded(true),w.LoadNestedTemplates(self.document.body,"")):void 0;w.LoadedTemplates().set_Item(b_,w.LoadedTemplateFile(""));};w.NamedTemplate=function(b_,b$,ca){var cb,cc;cb=(cc=null,[w.LoadedTemplateFile(b_).TryGetValue(b$==null?"":b$.$0,{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);return cb[0]?w.ChildrenTemplate(cb[1].cloneNode(true),ca):(b5.warn("Local template doesn't exist",b$),x.get_Empty());};w.LocalTemplatesLoaded=function(){_6.$cctor();return _6.LocalTemplatesLoaded;};w.set_LocalTemplatesLoaded=function(b_){_6.$cctor();_6.LocalTemplatesLoaded=b_;};w.LoadNestedTemplates=function(b_,b$){var cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn;function ca(co){var cp,cq;if(!cb.ContainsKey(co)){cp=(cq=null,[cc.TryGetValue(co,{get:function(){return cq;},set:function(cr){cq=cr;}}),cq]);cp[0]?(cn.Add(co),cc.Remove(co),w.PrepareTemplateStrict(b$,{$:1,$0:co},cp[1],{$:1,$0:ca})):b5.warn(cn.Contains(co)?"Encountered loop when instantiating "+co:"Local template does not exist: "+co);}}cb=w.LoadedTemplateFile(b$);cc=new A.New$5();cd=b_.querySelectorAll("[ws-template]");for(ce=0,cf=cd.length-1;ce<=cf;ce++){cg=cd[ce];ch=cg.getAttribute("ws-template").toLowerCase();cg.removeAttribute("ws-template");cc.set_Item(ch,w.FakeRootSingle(cg));}ci=b_.querySelectorAll("[ws-children-template]");for(cj=0,ck=ci.length-1;cj<=ck;cj++){cl=ci[cj];cm=cl.getAttribute("ws-children-template").toLowerCase();cl.removeAttribute("ws-children-template");cc.set_Item(cm,w.FakeRoot(cl));}cn=new H.New$3();while(cc.count>0)ca(I.head(cc.get_Keys()));};w.LoadedTemplates=function(){_6.$cctor();return _6.LoadedTemplates;};w.LoadedTemplateFile=function(b_){var b$,ca,cb;b$=(ca=null,[w.LoadedTemplates().TryGetValue(b_,{get:function(){return ca;},set:function(cc){ca=cc;}}),ca]);return b$[0]?b$[1]:(cb=new A.New$5(),(w.LoadedTemplates().set_Item(b_,cb),cb));};w.ChildrenTemplate=function(b_,b$){var ca,cb,cc,cd,ce;ca=w.InlineTemplate(b_,I.append(b$,w.GlobalHoles().get_Values()));cb=ca[1];cc=ca[0];cd=cc.Els;return!n.Equals(cd,null)&&cd.length===1&&(l.get(cd,0)instanceof L&&(n.Equals(l.get(cd,0).nodeType,L.ELEMENT_NODE)&&(ce=l.get(cd,0),true)))?bk.TreeNode(cc,cb):x.Mk({$:6,$0:cc},cb);};w.FakeRootSingle=function(b_){var b$,ca,cb,cc;b_.removeAttribute("ws-template");b$=b_.getAttribute("ws-replace");b$===null?void 0:(b_.removeAttribute("ws-replace"),ca=b_.parentNode,n.Equals(ca,null)?void 0:(cb=self.document.createElement(b_.tagName),cb.setAttribute("ws-replace",b$),ca.replaceChild(cb,b_)));cc=self.document.createElement("div");cc.appendChild(b_);return cc;};w.FakeRoot=function(b_){var b$;b$=self.document.createElement("div");while(b_.hasChildNodes())b$.appendChild(b_.firstChild);return b$;};w.PrepareTemplateStrict=function(b_,b$,ca,cb){var cc;function cd(ci,cj){var ck,cl,cm,cn,co,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK;function cp(cL){}while(true)switch(ci){case 0:if(cj!==null){ck=cj.nextSibling;if(n.Equals(cj.nodeType,L.TEXT_NODE))bl.convertTextNode(cj);else if(n.Equals(cj.nodeType,L.ELEMENT_NODE))cf(cj);cj=ck;}else return null;break;case 1:cq=bm.string(cj.nodeName,{$:1,$0:3},null).toLowerCase();cr=(cl=cq.indexOf("."),cl===-1?[b_,cq]:[bm.string(cq,null,{$:1,$0:cl-1}),bm.string(cq,{$:1,$0:cl+1},null)]);cs=cr[1];ct=cr[0];if(ct!==""&&!w.LoadedTemplates().ContainsKey(ct))return bl.failNotLoaded(cs);else{if(ct===""&&cb!=null)cb.$0(cs);cu=w.LoadedTemplates().get_Item(ct);if(!cu.ContainsKey(cs))return bl.failNotLoaded(cs);else{cv=cu.get_Item(cs);cw=cv.cloneNode(true);cx=new H.New$3();cy=new A.New$5();cz=cj.attributes;for(cA=0,cB=cz.length-1;cA<=cB;cA++){cC=cz.item(cA).name.toLowerCase();cy.set_Item(cC,(cD=cz.item(cA).nodeValue,cD===""?cC:cD.toLowerCase()));!cx.Add(cC)?b5.warn("Hole mapped twice",cC):void 0;}for(cE=0,cF=cj.childNodes.length-1;cE<=cF;cE++){cG=cj.childNodes[cE];n.Equals(cG.nodeType,L.ELEMENT_NODE)?!cx.Add(cG.nodeName.toLowerCase())?b5.warn("Hole filled twice",cs):void 0:void 0;}cH=cj.childNodes.length===1&&n.Equals(cj.firstChild.nodeType,L.TEXT_NODE);if(cH){cn=bl.fillTextHole(cw,cj.firstChild.textContent,cs);((function(cL){return function(cM){if(cM!=null)cL(cM.$0);};}((co=function(cL){return function(cM){return cL.Add(cM);};}(cx),function(cL){return cp(co(cL));})))(cn));}bl.removeHolesExcept(cw,cx);if(!cH){for(cI=0,cJ=cj.childNodes.length-1;cI<=cJ;cI++){cK=cj.childNodes[cI];n.Equals(cK.nodeType,L.ELEMENT_NODE)?cK.hasAttributes()?bl.fillInstanceAttrs(cw,cK):ce(cw,cK):void 0;}}bl.mapHoles(cw,cy);bl.fill(cw,cj.parentNode,cj);cj.parentNode.removeChild(cj);return;}}break;}}function ce(ci,cj){var ck,cm,cn;function cl(co,cp){var cq;if(cm==="title"&&cj.hasChildNodes()){cq=$.ParseHTMLIntoFakeRoot(cj.textContent);cj.removeChild(cj.firstChild);while(cq.hasChildNodes())cj.appendChild(cq.firstChild);}else null;cf(cj);return bl.fill(cj,co,cp);}cm=cj.nodeName.toLowerCase();w.foreachNotPreserved(ci,"[ws-attr-holes]",function(co){var cp,cq,cr,cs,ct;cp=X.SplitChars(co.getAttribute("ws-attr-holes"),[" "],1);for(cq=0,cr=cp.length-1;cq<=cr;cq++){cs=l.get(cp,cq);co.setAttribute(cs,(ct=new a.RegExp("\\${"+cm+"}","ig"),co.getAttribute(cs).replace(ct,cj.textContent)));}});cn=ci.querySelector("[ws-hole="+cm+"]");if(n.Equals(cn,null)){ck=ci.querySelector("[ws-replace="+cm+"]");return n.Equals(ck,null)?null:(cl(ck.parentNode,ck),void ck.parentNode.removeChild(ck));}else{while(cn.hasChildNodes())cn.removeChild(cn.lastChild);cn.removeAttribute("ws-hole");return cl(cn,null);}}function cf(ci){if(!ci.hasAttribute("ws-preserve"))if(X.StartsWith(ci.nodeName.toLowerCase(),"ws-"))ch(ci);else{bl.convertAttrs(ci);cg(ci.firstChild);}}function cg(ci){return cd(0,ci);}function ch(ci){return cd(1,ci);}cc=(b$==null?"":b$.$0).toLowerCase();w.LoadedTemplateFile(b_).set_Item(cc,ca);ca.hasChildNodes()?(function(ci){var cj,ck,cl,cm;while(true){cj=ci.querySelector("[ws-template]");if(n.Equals(cj,null)){ck=ci.querySelector("[ws-children-template]");if(n.Equals(ck,null))return null;else{cl=ck.getAttribute("ws-children-template");ck.removeAttribute("ws-children-template");w.PrepareTemplateStrict(b_,{$:1,$0:cl},ck,null);ci=ci;}}else{cm=cj.getAttribute("ws-template");(w.PrepareSingleTemplate(b_,{$:1,$0:cm},cj))(null);ci=ci;}}}(ca),cg(ca.firstChild)):void 0;};w.InlineTemplate=function(b_,b$){var ca,cb,cc,cd,cg,ch,ci,cj,ck,cl,cm;function ce(cn,co){var cp,cq,cr;cp=bt.Insert(cn,co);ch.push(bt.Updates(cp));ci.push([cn,cp]);cq=b7.GetOptional(cp.OnAfterRender);return cq==null?null:(cr=cq.$0,void cj.push(function(){cr(cn);}));}function cf(cn){var co,cp;co=(cp=null,[ck.TryGetValue(cn,{get:function(){return cp;},set:function(cq){cp=cq;}}),cp]);return co[0]?co[1].$==0?{$:1,$0:co[1].$1}:co[1].$==1?{$:1,$0:x.TextNode(co[1].$1)}:co[1].$==2?{$:1,$0:x.TextView(co[1].$1)}:co[1].$==8?{$:1,$0:x.TextView(co[1].$1.get_View())}:co[1].$==9?{$:1,$0:x.TextView(N.Map(a.String,co[1].$1.get_View()))}:co[1].$==10?{$:1,$0:x.TextView(N.Map(function(cq){return cq.get_Input();},co[1].$1.get_View()))}:co[1].$==11?{$:1,$0:x.TextView(N.Map(a.String,co[1].$1.get_View()))}:co[1].$==12?{$:1,$0:x.TextView(N.Map(function(cq){return cq.get_Input();},co[1].$1.get_View()))}:co[1].$==13?{$:1,$0:x.TextView(N.Map(a.String,co[1].$1.get_View()))}:(b5.warn("Content hole filled with attribute data",cn),null):null;}cg=[];ch=[];ci=[];cj=[];ck=new A.New$5();cl=_4.Get(b$);try{while(cl.MoveNext()){cm=cl.Current();ck.set_Item(cm.$0,cm);}}finally{if(typeof cl=="object"&&"Dispose"in cl)cl.Dispose();}ca=$.ChildrenArray(b_);w.foreachNotPreserved(b_,"[ws-hole]",function(cn){var co,cp,cq;cq=cn.getAttribute("ws-hole");cn.removeAttribute("ws-hole");while(cn.hasChildNodes())cn.removeChild(cn.lastChild);co=cf(cq);co!=null&&co.$==1?(cp=co.$0,_8.LinkElement(cn,cp.docNode),cg.push(_9.New(bt.Empty(cn),cp.docNode,null,cn,bj.Int(),null)),ch.push(cp.updates)):void 0;});w.foreachNotPreserved(b_,"[ws-replace]",function(cn){var co,cp,cq,cr,cs,ct;co=cf(cn.getAttribute("ws-replace"));co!=null&&co.$==1?(cp=co.$0,cq=cn.parentNode,cr=self.document.createTextNode(""),cq.replaceChild(cr,cn),cs=_8.InsertBeforeDelim(cr,cp.docNode),ct=l.tryFindIndex(function(cu){return cn===cu;},ca),ct==null?void 0:l.set(ca,ct.$0,cp.docNode),cg.push(_9.New(bt.Empty(cq),cp.docNode,{$:1,$0:[cs,cr]},cq,bj.Int(),null)),ch.push(cp.updates)):void 0;});w.foreachNotPreserved(b_,"[ws-attr]",function(cn){var co,cp,cq;co=cn.getAttribute("ws-attr");cn.removeAttribute("ws-attr");cp=(cq=null,[ck.TryGetValue(co,{get:function(){return cq;},set:function(cr){cq=cr;}}),cq]);cp[0]?cp[1].$==3?ce(cn,cp[1].$1):b5.warn("Attribute hole filled with non-attribute data",co):void 0;});w.foreachNotPreserved(b_,"[ws-on]",function(cn){ce(cn,Q.Concat(l.choose(function(co){var cp,cq,cr;cp=X.SplitChars(co,[":"],1);cq=(cr=null,[ck.TryGetValue(l.get(cp,1),{get:function(){return cr;},set:function(cs){cr=cs;}}),cr]);return cq[0]?cq[1].$==4?{$:1,$0:bv.Handler(l.get(cp,0),cq[1].$1)}:cq[1].$==5?{$:1,$0:Q.Handler(l.get(cp,0),cq[1].$1)}:(b5.warn("Event hole on"+l.get(cp,0)+" filled with non-event data",l.get(cp,1)),null):null;},X.SplitChars(cn.getAttribute("ws-on"),[" "],1))));cn.removeAttribute("ws-on");});w.foreachNotPreserved(b_,"[ws-onafterrender]",function(cn){var co,cp,cq;co=cn.getAttribute("ws-onafterrender");cp=(cq=null,[ck.TryGetValue(co,{get:function(){return cq;},set:function(cr){cq=cr;}}),cq]);cp[0]?cp[1].$==6?(cn.removeAttribute("ws-onafterrender"),ce(cn,bv.OnAfterRender(cp[1].$1))):cp[1].$==7?(cn.removeAttribute("ws-onafterrender"),ce(cn,bv.OnAfterRender(cp[1].$1))):b5.warn("onafterrender hole filled with non-onafterrender data",co):void 0;});w.foreachNotPreserved(b_,"[ws-var]",function(cn){var co,cp,cq;co=cn.getAttribute("ws-var");cn.removeAttribute("ws-var");cp=(cq=null,[ck.TryGetValue(co,{get:function(){return cq;},set:function(cr){cq=cr;}}),cq]);cp[0]?cp[1].$==8?ce(cn,bv.Value(cp[1].$1)):cp[1].$==9?ce(cn,bv.Checked(cp[1].$1)):cp[1].$==10?ce(cn,bv.IntValue(cp[1].$1)):cp[1].$==11?ce(cn,bv.IntValueUnchecked(cp[1].$1)):cp[1].$==12?ce(cn,bv.FloatValue(cp[1].$1)):cp[1].$==13?ce(cn,bv.FloatValueUnchecked(cp[1].$1)):b5.warn("Var hole filled with non-Var data",co):void 0;});w.foreachNotPreserved(b_,"[ws-attr-holes]",function(cn){var co,cp,cq,cr;co=new a.RegExp(w.TextHoleRE(),"g");cp=X.SplitChars(cn.getAttribute("ws-attr-holes"),[" "],1);cn.removeAttribute("ws-attr-holes");for(cq=0,cr=cp.length-1;cq<=cr;cq++)(function(){var cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE;cB=l.get(cp,cq);cC=cn.getAttribute(cB);cs=null;ct=0;cD=[];while(cs=co.exec(cC),cs!==null){cE=bm.string(cC,{$:1,$0:ct},{$:1,$0:co.lastIndex-l.get(cs,0).length-1});ct=co.lastIndex;cD.push([cE,l.get(cs,1)]);}cv=bm.string(cC,{$:1,$0:ct},null);co.lastIndex=0;cw=l.foldBack(function(cF,cG){return(function(cH){var cI,cJ;cI=cH[0];cJ=cH[1];return function(cK){var cL,cM,cN,cO,cP;cL=cK[0];cM=cK[1];cN=(cO=(cP=null,[ck.TryGetValue(cJ,{get:function(){return cP;},set:function(cQ){cP=cQ;}}),cP]),cO[0]?cO[1].$==1?{$:0,$0:cO[1].$1}:cO[1].$==2?{$:1,$0:cO[1].$1}:cO[1].$==8?{$:1,$0:cO[1].$1.get_View()}:cO[1].$==9?{$:1,$0:N.Map(a.String,cO[1].$1.get_View())}:cO[1].$==10?{$:1,$0:N.Map(function(cQ){return cQ.get_Input();},cO[1].$1.get_View())}:cO[1].$==11?{$:1,$0:N.Map(a.String,cO[1].$1.get_View())}:cO[1].$==12?{$:1,$0:N.Map(function(cQ){return cQ.get_Input();},cO[1].$1.get_View())}:cO[1].$==13?{$:1,$0:N.Map(a.String,cO[1].$1.get_View())}:(b5.warn("Attribute value hole filled with non-text data",cJ),{$:0,$0:""}):{$:0,$0:""});return cN.$==1?[cI,new bd({$:1,$0:cL===""?cN.$0:N.Map(function(cQ){return cQ+cL;},cN.$0),$1:cM})]:[cI+cN.$0+cL,cM];};}(cF))(cG);},cD,[cv,bd.Empty]);return ce(cn,cw[1].$==1?cw[1].$1.$==1?cw[1].$1.$1.$==1?cw[1].$1.$1.$1.$==0?(cx=cw[0],bv.Dynamic(cB,N.Map3(function(cF,cG,cH){return cx+cF+cG+cH;},cw[1].$0,cw[1].$1.$0,cw[1].$1.$1.$0))):(cy=cw[0],bv.Dynamic(cB,N.Map(function(cF){return cy+X.concat("",cF);},N.Sequence(cw[1])))):(cz=cw[0],bv.Dynamic(cB,N.Map2(function(cF,cG){return cz+cF+cG;},cw[1].$0,cw[1].$1.$0))):cw[0]===""?bv.Dynamic(cB,cw[1].$0):(cA=cw[0],bv.Dynamic(cB,N.Map(function(cF){return cA+cF;},cw[1].$0))):Q.Create(cB,cw[0]));}());});return[b7.DeleteEmptyFields({Els:ca,Dirty:true,Holes:cg,Attrs:ci,Render:(cb=cj.length==0?null:{$:1,$0:function(cn){l.iter(function(co){co(cn);},cj);}},cb?cb.$0:void 0),El:(cc=!n.Equals(ca,null)&&ca.length===1&&(l.get(ca,0)instanceof L&&(l.get(ca,0)instanceof a.Element&&(cd=l.get(ca,0),true)))?{$:1,$0:cd}:null,cc?cc.$0:void 0)},["Render","El"]),ba.TreeReduce(N.Const(),N.Map2Unit,ch)];};w.GlobalHoles=function(){_6.$cctor();return _6.GlobalHoles;};w.foreachNotPreserved=function(b_,b$,ca){$.IterSelector(b_,b$,function(cb){if(cb.closest("[ws-preserve]")==null)ca(cb);});};w.PrepareSingleTemplate=function(b_,b$,ca){var cb;cb=w.FakeRootSingle(ca);return function(cc){w.PrepareTemplateStrict(b_,b$,cb,cc);};};w.TextHoleRE=function(){_6.$cctor();return _6.TextHoleRE;};x=g.Doc=b7.Class({},f,x);x.RunById=function(b_,b$){var ca;ca=self.document.getElementById(b_);n.Equals(ca,null)?e.FailWith("invalid id: "+b_):x.Run(ca,b$);};x.Run=function(b_,b$){_8.LinkElement(b_,b$.docNode);x.RunInPlace(false,b_,b$);};x.TextNode=function(b_){return x.Mk({$:5,$0:self.document.createTextNode(b_)},N.Const());};x.Concat=function(b_){var b$;b$=ba.ofSeqNonCopying(b_);return ba.TreeReduce(x.get_Empty(),x.Append,b$);};x.get_Empty=function(){return x.Mk(null,N.Const());};x.RunInPlace=function(b_,b$,ca){var cb;cb=_8.CreateRunState(b$,ca.docNode);N.Sink(bo.get_UseAnimations()||bp.BatchUpdatesEnabled()?bq.StartProcessor(_8.PerformAnimatedUpdate(b_,cb,ca.docNode)):function(){_8.PerformSyncUpdate(b_,cb,ca.docNode);},ca.updates);};x.Element=function(b_,b$,ca){var cb,cc;cb=Q.Concat(b$);cc=x.Concat(ca);return bk.New(self.document.createElement(b_),cb,cc);};x.Mk=function(b_,b$){return new x.New(b_,b$);};x.Button=function(b_,b$,ca){var cb;cb=Q.Concat(b$);return bk.New(x.Clickable("button",ca),cb,x.TextNode(b_));};x.BindView=function(b_,b$){return x.EmbedView(N.Map(b_,b$));};x.Append=function(b_,b$){return x.Mk({$:0,$0:b_.docNode,$1:b$.docNode},N.Map2Unit(b_.updates,b$.updates));};x.Clickable=function(b_,b$){var ca;ca=self.document.createElement(b_);ca.addEventListener("click",function(cb){cb.preventDefault();return b$();},false);return ca;};x.EmbedView=function(b_){var b$;b$=_8.CreateEmbedNode();return x.Mk({$:2,$0:b$},N.Map(a.ignore,N.Bind(function(ca){_8.UpdateEmbedNode(b$,ca.docNode);return ca.updates;},b_)));};x.TextView=function(b_){var b$;b$=_8.CreateTextNode();return x.Mk({$:4,$0:b$},N.Map(function(ca){_8.UpdateTextNode(b$,ca);},b_));};x.New=b7.Ctor(function(b_,b$){f.New.call(this);this.docNode=b_;this.updates=b$;},x);z.NewFromSeq=function(b_){var b$,ca,cb;b$={};ca=_4.Get(b_);try{while(ca.MoveNext()){cb=ca.Current();b$[cb[0]]=cb[1];}}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}return b$;};A=s.Dictionary=b7.Class({set_Item:function(b_,b$){this.set(b_,b$);},set:function(b_,b$){var ca,cb,cc,cd;ca=this;cb=this.hash(b_);cc=this.data[cb];cc==null?(this.count=this.count+1,this.data[cb]=new a.Array({K:b_,V:b$})):(cd=l.tryFindIndex(function(ce){return ca.equals.apply(null,[(e.KeyValue(ce))[0],b_]);},cc),cd==null?(this.count=this.count+1,cc.push({K:b_,V:b$})):cc[cd.$0]={K:b_,V:b$});},TryGetValue:function(b_,b$){var ca,cb,cc;ca=this;cb=this.data[this.hash(b_)];return cb==null?false:(cc=l.tryPick(function(cd){var ce;ce=e.KeyValue(cd);return ca.equals.apply(null,[ce[0],b_])?{$:1,$0:ce[1]}:null;},cb),cc!=null&&cc.$==1&&(b$.set(cc.$0),true));},ContainsKey:function(b_){var b$,ca;b$=this;ca=this.data[this.hash(b_)];return ca==null?false:l.exists(function(cb){return b$.equals.apply(null,[(e.KeyValue(cb))[0],b_]);},ca);},Remove:function(b_){return this.remove(b_);},get_Keys:function(){return new bn.New(this);},get_Values:function(){return new bx.New(this);},remove:function(b_){var b$,ca,cb,cc;b$=this;ca=this.hash(b_);cb=this.data[ca];return cb==null?false:(cc=l.filter(function(cd){return!b$.equals.apply(null,[(e.KeyValue(cd))[0],b_]);},cb),l.length(cc)<cb.length&&(this.count=this.count-1,this.data[ca]=cc,true));},get_Item:function(b_){return this.get(b_);},get:function(b_){var b$,ca;b$=this;ca=this.data[this.hash(b_)];return ca==null?_3.notPresent():l.pick(function(cb){var cc;cc=e.KeyValue(cb);return b$.equals.apply(null,[cc[0],b_])?{$:1,$0:cc[1]}:null;},ca);},GetEnumerator:function(){return _4.Get0(this);},GetEnumerator0:function(){return _4.Get0(l.concat(M.GetFieldValues(this.data)));}},f,A);A.New$5=b7.Ctor(function(){A.New$6.call(this,[],n.Equals,n.Hash);},A);A.New$6=b7.Ctor(function(b_,b$,ca){var cb,cc;f.New.call(this);this.equals=b$;this.hash=ca;this.count=0;this.data=[];cb=_4.Get(b_);try{while(cb.MoveNext()){cc=cb.Current();this.set(cc.K,cc.V);}}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}},A);B.Solve=function(b_){var b$,ca,cb,cc,cd;b$=V.New(B.readInts(b_),0,false);ca=true;cb=W.New(l.get(b$.memory,b$.position),l.get(b$.memory,b$.position+1),l.get(b$.memory,b$.position+2),l.get(b$.memory,b$.position+3));cc=l.mapi(function(ce,cf){return ce===1?12:ce===2?2:cf;},b$.memory);cd=false;return l.get(I.last(I.unfold(function(ce){var cf;return ce.finished?null:(cf=B.runCmd(ca?cb:W.New(l.get(ce.memory,ce.position),l.get(ce.memory,ce.position+1),l.get(ce.memory,ce.position+2),l.get(ce.memory,ce.position+3)),ca?V.New(cc,ce.position,ce.finished):ce),(ca?ca=false:void 0,{$:1,$0:[cf,cf]}));},b$)).memory,0);};B.runCmd=function(b_,b$){var ca,cb,cc;ca=b_.opcode;return ca===1?(cb=l.mapi(function(cd,ce){return cd===b_.dest?l.get(b$.memory,b_.op1)+l.get(b$.memory,b_.op2):ce;},b$.memory),V.New(cb,b$.position+4,l.get(cb,b$.position+4)===99)):ca===2?(cc=l.mapi(function(cd,ce){return cd===b_.dest?l.get(b$.memory,b_.op1)*l.get(b$.memory,b_.op2):ce;},b$.memory),V.New(cc,b$.position+4,l.get(cc,b$.position+4)===99)):e.FailWith("wrong position");};B.readInts=function(b_){return l.map(O.ParseInt32,X.SplitChars(b_,[","],0));};l.filter=function(b_,b$){var ca,cb,cc;ca=[];for(cb=0,cc=b$.length-1;cb<=cc;cb++)if(b_(b$[cb]))ca.push(b$[cb]);return ca;};l.map=function(b_,b$){var ca,cb,cc;ca=new a.Array(b$.length);for(cb=0,cc=b$.length-1;cb<=cc;cb++)ca[cb]=b_(b$[cb]);return ca;};l.choose=function(b_,b$){var ca,cb,cc,cd;ca=[];for(cb=0,cc=b$.length-1;cb<=cc;cb++){cd=b_(b$[cb]);cd==null?void 0:ca.push(cd.$0);}return ca;};l.mapi=function(b_,b$){var ca,cb,cc;ca=new a.Array(b$.length);for(cb=0,cc=b$.length-1;cb<=cc;cb++)ca[cb]=b_(cb,b$[cb]);return ca;};l.fold=function(b_,b$,ca){var cb,cc,cd;cb=b$;for(cc=0,cd=ca.length-1;cc<=cd;cc++)cb=b_(cb,ca[cc]);return cb;};l.forall=function(b_,b$){var ca,cb,cc,cd;ca=true;cb=0;cd=l.length(b$);while(ca&&cb<cd)if(b_(b$[cb]))cb=cb+1;else ca=false;return ca;};l.head=function(b_){l.nonEmpty(b_);return b_[0];};l.skip=function(b_,b$){return b_<0?I.nonNegative():b_>b$.length?I.insufficient():b$.slice(b_);};l.take=function(b_,b$){return b_<0?I.nonNegative():b_>b$.length?I.insufficient():b$.slice(0,b_);};l.tryFindIndex=function(b_,b$){var ca,cb;ca=null;cb=0;while(cb<b$.length&&ca==null){b_(b$[cb])?ca={$:1,$0:cb}:void 0;cb=cb+1;}return ca;};l.tryPick=function(b_,b$){var ca,cb,cc;ca=null;cb=0;while(cb<b$.length&&ca==null){cc=b_(b$[cb]);cc!=null&&cc.$==1?ca=cc:void 0;cb=cb+1;}return ca;};l.exists=function(b_,b$){var ca,cb,cc,cd;ca=false;cb=0;cd=l.length(b$);while(!ca&&cb<cd)if(b_(b$[cb]))ca=true;else cb=cb+1;return ca;};l.concat=function(b_){return a.Array.prototype.concat.apply([],l.ofSeq(b_));};l.ofList=function(b_){var b$,ca;ca=[];b$=b_;while(!(b$.$==0)){ca.push(_0.head(b$));b$=_0.tail(b$);}return ca;};l.nonEmpty=function(b_){if(b_.length===0)e.FailWith("The input array was empty.");};l.foldBack=function(b_,b$,ca){var cb,cc,cd,ce,cf;cb=ca;cd=b$.length;for(ce=1,cf=cd;ce<=cf;ce++)cb=b_(b$[cd-ce],cb);return cb;};l.iter=function(b_,b$){var ca,cb;for(ca=0,cb=b$.length-1;ca<=cb;ca++)b_(b$[ca]);};l.ofSeq=function(b_){var b$,ca;if(b_ instanceof a.Array)return b_.slice();else if(b_ instanceof bd)return l.ofList(b_);else{b$=[];ca=_4.Get(b_);try{while(ca.MoveNext())b$.push(ca.Current());return b$;}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}}};l.init=function(b_,b$){var ca,cb,cc;b_<0?e.FailWith("Negative size given."):null;ca=new a.Array(b_);for(cb=0,cc=b_-1;cb<=cc;cb++)ca[cb]=b$(cb);return ca;};l.pick=function(b_,b$){var ca;ca=l.tryPick(b_,b$);return ca==null?e.FailWith("KeyNotFoundException"):ca.$0;};l.create=function(b_,b$){var ca,cb,cc;ca=new a.Array(b_);for(cb=0,cc=b_-1;cb<=cc;cb++)ca[cb]=b$;return ca;};C.cleanLine=function(b_){return X.Trim(X.Replace(X.Replace(b_,"\n",""),"\r",""));};C.solver=function(b_,b$,ca,cb){return C.generator(C.analyse,b_,b$,ca,cb);};C.phase=function(b_,b$,ca,cb){var cc,cd;cc=l.get(cb,0).length;cd=l.length(cb);return C.solver(ca,function(ce,cf){return((b_(cc,cd,b$))(ce))(cf);},C.start(),cb).curr_list;};C.generator=function(b_,b$,ca,cb,cc){return l.fold(ca,cb,b_(b$,cc));};C.analyse=function(b_,b$){return l.map(b_,b$);};C.start=function(){bu.$cctor();return bu.start;};D.phase1=function(b_){var b$,ca;b$=l.get(b_,0).length;ca=l.length(b_);b5.log("cols",b$,"rows",ca);return C.solver(D.liner,function(cb,cc){return D.step1(b$,ca,cb,cc);},D.start(),b_).result;};D.phase2=function(b_){var b$,ca;b$=l.get(b_,0).length;ca=l.length(b_);b5.log("cols",b$,"rows",ca);return l.fold(function(cb,cc){return cb*cc;},1,l.map(function(cb){return C.solver(D.liner,function(cc,cd){return D.step(b$,ca,cb,cc,cd);},D.start(),b_).result;},[Z.New(1,1),Z.New(3,1),Z.New(5,1),Z.New(7,1),Z.New(1,2)]));};D.liner=function(b_){return l.map(function(b$){return b$==="#";},X.ToCharArray(b_));};D.step1=function(b_,b$,ca,cb){return D.step(b_,b$,D.move1(),ca,cb);};D.start=function(){bb.$cctor();return bb.start;};D.step=function(b_,b$,ca,cb,cc){return cb.curr_row<cb.ypos?Y.New(cb.result,cb.xpos,cb.ypos,cb.curr_row+1):Y.New(l.get(cc,cb.xpos)?cb.result+1:cb.result,(cb.xpos+ca.right)%b_,(cb.ypos+ca.down)%b$,cb.curr_row+1);};D.move1=function(){bb.$cctor();return bb.move1;};E.phase1=function(b_){return I.sum(C.phase(function(b$,ca,cb){return b7.Curried(E.step1,2,[E.read1,b$,ca,cb]);},E.move1(),E.liner,b_));};E.phase2=function(b_){return I.sum(C.phase(function(b$,ca,cb){return((((E.step2())(E.read2))(b$))(ca))(cb);},E.move2(),E.liner,b_));};E.step1=function(b_,b$,ca,cb,cc,cd){return bc.New(cc.result,cc.xpos,cc.ypos,cc.curr_row+1,new bd({$:1,$0:b_(cd),$1:cc.curr_list}));};E.read1=function(b_){return l.forall(function(b$){return _0.contains(b$,_0.map(l.head,b_));},E.fields())?1:0;};E.move1=function(){be.$cctor();return be.move1;};E.liner=function(b_){return _0.ofArray(l.map(function(b$){return X.SplitChars(b$,[":"],0);},X.SplitChars(b_,[" "],0)));};E.step2=function(){be.$cctor();return be.step2;};E.read2=function(b_){return l.forall(function(b$){return _0.exists(function(ca){var cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs;if(l.get(ca,0)===b$){cs=l.get(ca,0);if(cs==="byr"){cb=(cc=0,[O.TryParseInt32(l.get(ca,1),{get:function(){return cc;},set:function(ct){cc=ct;}}),cc]);return cb[0]&&(cd=cb[1],cd>=1920&&cd<=2002);}else if(cs==="iyr"){ce=(cf=0,[O.TryParseInt32(l.get(ca,1),{get:function(){return cf;},set:function(ct){cf=ct;}}),cf]);return ce[0]&&(cg=ce[1],cg>=2010&&cg<=2020);}else if(cs==="eyr"){ch=(ci=0,[O.TryParseInt32(l.get(ca,1),{get:function(){return ci;},set:function(ct){ci=ct;}}),ci]);return ch[0]&&(cj=ch[1],cj>=2020&&cj<=2030);}else if(cs==="hgt")return X.EndsWith(l.get(ca,1),"cm")?(ck=(cl=0,[O.TryParseInt32(X.Substring(l.get(ca,1),0,l.get(ca,1).length-2),{get:function(){return cl;},set:function(ct){cl=ct;}}),cl]),ck[0]&&(cm=ck[1],cm>=150&&cm<=193)):X.EndsWith(l.get(ca,1),"in")&&(cn=(co=0,[O.TryParseInt32(X.Substring(l.get(ca,1),0,l.get(ca,1).length-2),{get:function(){return co;},set:function(ct){co=ct;}}),co]),cn[0]&&(cp=cn[1],cp>=59&&cp<=76));else if(cs==="hcl")return l.get(ca,1).length===7&&(cq=_0.ofArray(X.ToCharArray(l.get(ca,1))),cq.$==1&&(cq.$0==="#"&&(_0.forAll(function(ct){return ct.charCodeAt()>="a".charCodeAt()&&ct.charCodeAt()<="f".charCodeAt()||ct.charCodeAt()>="0".charCodeAt()&&ct.charCodeAt()<="9".charCodeAt();},cq.$1)||false)));else if(cs==="ecl"){cr=l.get(ca,1);return cr==="amb"||(cr==="blu"||(cr==="brn"||(cr==="gry"||(cr==="grn"||(cr==="hzl"||(cr==="oth"||false))))));}else if(cs==="pid")return l.get(ca,1).length===9&&l.forall(function(ct){return ct.charCodeAt()>="0".charCodeAt()&&ct.charCodeAt()<="9".charCodeAt();},X.ToCharArray(l.get(ca,1)));else if(cs==="cid")return true;else throw new bg.New("Year2020Day4.fs",67,26);}else return false;},b_);},E.fields())?1:0;};E.move2=function(){be.$cctor();return be.move2;};E.fields=function(){be.$cctor();return be.fields;};E.txtFields=function(){be.$cctor();return be.txtFields;};F.phase1=function(b_){return _0.max(C.phase(function(b$,ca,cb){return b7.Curried(F.step1,2,[F.read1,b$,ca,cb]);},F.move1(),F.liner,b_));};F.phase2=function(b_){var b$,ca;b$=C.phase(function(cb,cc,cd){return((((F.step2())(F.read2()))(cb))(cc))(cd);},F.move2(),F.liner,b_);ca=_0.filter(function(cb){return _0.contains(cb-1,b$)&&_0.contains(cb+1,b$)&&!_0.contains(cb,b$);},_0.ofSeq(e.range(_0.min(b$),_0.max(b$))));_0.iter(function(cb){return function(cc){return cb(a.String(cc));};}(function(cb){b5.log(cb);}),ca);return _0.head(ca);};F.step1=function(b_,b$,ca,cb,cc,cd){return bc.New(cc.result,cc.xpos,cc.ypos,cc.curr_row+1,new bd({$:1,$0:8*b_(function(ce){return function(cf){return l.take(ce,cf);};},"F","B",l.get(cb,0),cd)+b_(function(ce){return function(cf){return l.skip(ce,cf);};},"L","R",l.get(cb,1),cd),$1:cc.curr_list}));};F.read1=function(b_,b$,ca,cb,cc){return l.head(l.fold(function(cd,ce){var cf;cf=l.length(cd)/2>>0;return n.Equals(ce,b$)?l.take(cf,cd):l.skip(cf,cd);},cb,(b_(7))(cc)));};F.move1=function(){bh.$cctor();return bh.move1;};F.liner=function(b_){return X.ToCharArray(b_);};F.step2=function(){bh.$cctor();return bh.step2;};F.read2=function(){bh.$cctor();return bh.read2;};F.move2=function(){bh.$cctor();return bh.move2;};G=g.Var$1=b7.Class({},f,G);G.Create$1=function(b_){return new _1.New(false,_2.New({$:2,$0:b_,$1:[]}),b_);};H=s.HashSet=b7.Class({Add:function(b_){return this.add(b_);},Contains:function(b_){var b$;b$=this.data[this.hash(b_)];return b$==null?false:this.arrContains(b_,b$);},add:function(b_){var b$,ca;b$=this.hash(b_);ca=this.data[b$];return ca==null?(this.data[b$]=[b_],this.count=this.count+1,true):this.arrContains(b_,ca)?false:(ca.push(b_),this.count=this.count+1,true);},arrContains:function(b_,b$){var ca,cb,cc,cd;ca=true;cb=0;cd=b$.length;while(ca&&cb<cd)if(this.equals.apply(null,[b$[cb],b_]))ca=false;else cb=cb+1;return!ca;},ExceptWith:function(b_){var b$;b$=_4.Get(b_);try{while(b$.MoveNext())this.Remove(b$.Current());}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}},get_Count:function(){return this.count;},CopyTo:function(b_){var b$,ca,cb,cc;b$=0;ca=bE.concat(this.data);for(cb=0,cc=ca.length-1;cb<=cc;cb++)l.set(b_,cb,ca[cb]);},IntersectWith:function(b_){var b$,ca,cb,cc,cd;b$=new H.New$4(b_,this.equals,this.hash);ca=bE.concat(this.data);for(cb=0,cc=ca.length-1;cb<=cc;cb++){cd=ca[cb];!b$.Contains(cd)?this.Remove(cd):void 0;}},Remove:function(b_){var b$;b$=this.data[this.hash(b_)];return b$==null?false:this.arrRemove(b_,b$)&&(this.count=this.count-1,true);},arrRemove:function(b_,b$){var ca,cb,cc,cd;ca=true;cb=0;cd=b$.length;while(ca&&cb<cd)if(this.equals.apply(null,[b$[cb],b_])){b$.splice.apply(b$,[cb,1]);ca=false;}else cb=cb+1;return!ca;},GetEnumerator:function(){return _4.Get(bE.concat(this.data));},GetEnumerator0:function(){return _4.Get(bE.concat(this.data));}},f,H);H.New$3=b7.Ctor(function(){H.New$4.call(this,[],n.Equals,n.Hash);},H);H.New$4=b7.Ctor(function(b_,b$,ca){var cb;f.New.call(this);this.equals=b$;this.hash=ca;this.data=[];this.count=0;cb=_4.Get(b_);try{while(cb.MoveNext())this.add(cb.Current());}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}},H);H.New$2=b7.Ctor(function(b_){H.New$4.call(this,b_,n.Equals,n.Hash);},H);I.append=function(b_,b$){return{GetEnumerator:function(){var ca,cb;ca=_4.Get(b_);cb=[true];return new _5.New(ca,null,function(cc){var cd;return cc.s.MoveNext()?(cc.c=cc.s.Current(),true):(cd=cc.s,!n.Equals(cd,null)?cd.Dispose():void 0,cc.s=null,cb[0]&&(cb[0]=false,cc.s=_4.Get(b$),cc.s.MoveNext()?(cc.c=cc.s.Current(),true):(cc.s.Dispose(),cc.s=null,false)));},function(cc){var cd;cd=cc.s;!n.Equals(cd,null)?cd.Dispose():void 0;});}};};I.unfold=function(b_,b$){return{GetEnumerator:function(){return new _5.New(b$,null,function(ca){var cb;cb=b_(ca.s);return cb==null?false:(ca.c=cb.$0[0],ca.s=cb.$0[1],true);},void 0);}};};I.head=function(b_){var b$;b$=_4.Get(b_);try{return b$.MoveNext()?b$.Current():I.insufficient();}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}};I.sum=function(b_){return I.fold(function(b$,ca){return b$+ca;},0,b_);};I.init=function(b_,b$){return I.take(b_,I.initInfinite(b$));};I.filter=function(b_,b$){return{GetEnumerator:function(){var ca;ca=_4.Get(b$);return new _5.New(null,null,function(cb){var cc,cd,ce;cc=ca.MoveNext();cd=ca.Current();ce=false;while(cc)if(b_(cd)){cb.c=cd;ce=true;cc=false;}else if(ca.MoveNext())cd=ca.Current();else cc=false;return ce;},function(){ca.Dispose();});}};};I.fold=function(b_,b$,ca){var cb,cc;cb=b$;cc=_4.Get(ca);try{while(cc.MoveNext())cb=b_(cb,cc.Current());return cb;}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}};I.take=function(b_,b$){b_<0?I.nonNegative():void 0;return{GetEnumerator:function(){var ca;ca=[_4.Get(b$)];return new _5.New(0,null,function(cb){var cc;cb.s=cb.s+1;return cb.s>b_?false:(cc=ca[0],n.Equals(cc,null)?I.insufficient():cc.MoveNext()?(cb.c=cc.Current(),cb.s===b_?(cc.Dispose(),ca[0]=null):void 0,true):(cc.Dispose(),ca[0]=null,I.insufficient()));},function(){var cb;cb=ca[0];!n.Equals(cb,null)?cb.Dispose():void 0;});}};};I.initInfinite=function(b_){return{GetEnumerator:function(){return new _5.New(0,null,function(b$){b$.c=b_(b$.s);b$.s=b$.s+1;return true;},void 0);}};};I.iter=function(b_,b$){var ca;ca=_4.Get(b$);try{while(ca.MoveNext())b_(ca.Current());}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}};I.map=function(b_,b$){return{GetEnumerator:function(){var ca;ca=_4.Get(b$);return new _5.New(null,null,function(cb){return ca.MoveNext()&&(cb.c=b_(ca.Current()),true);},function(){ca.Dispose();});}};};I.max=function(b_){var b$,ca,cb;b$=_4.Get(b_);try{if(!b$.MoveNext())I.seqEmpty();ca=b$.Current();while(b$.MoveNext()){cb=b$.Current();n.Compare(cb,ca)===1?ca=cb:void 0;}return ca;}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}};I.seqEmpty=function(){return e.FailWith("The input sequence was empty.");};I.forall=function(b_,b$){return!I.exists(function(ca){return!b_(ca);},b$);};I.exists=function(b_,b$){var ca,cb;ca=_4.Get(b$);try{cb=false;while(!cb&&ca.MoveNext())cb=b_(ca.Current());return cb;}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}};J.$cctor=function(){J.$cctor=a.ignore;J.initialized=new A.New$5();};J=j.TemplateInitializer=b7.Class({},f,J);J.GetOrAddHoleFor=function(b_,b$,ca){var cb,cc,cd,ce;J.$cctor();cb=J.GetHolesFor(b_);cc=(cd=null,[cb.TryGetValue(b$,{get:function(){return cd;},set:function(cf){cd=cf;}}),cd]);return cc[0]?cc[1]:(ce=ca(),(cb.set_Item(b$,ce),ce));};J.GetHolesFor=function(b_){var b$,ca,cb;J.$cctor();b$=(ca=null,[J.initialized.TryGetValue(b_,{get:function(){return ca;},set:function(cc){ca=cc;}}),ca]);return b$[0]?b$[1]:(cb=new A.New$5(),(J.initialized.set_Item(b_,cb),cb));};M.GetFieldValues=function(b_){var b$,ca;b$=[];for(var cb in b_)b$.push(b_[cb]);return b$;};N=g.View=b7.Class({},null,N);O.ParseInt32=function(b_){return O.Parse(b_,-2147483648,2147483647,"Value was either too large or too small for an Int32.");};O.TryParseInt32=function(b_,b$){return O.TryParse(b_,-2147483648,2147483647,b$);};Q=g.AttrProxy=b7.Class({},null,Q);Q.Create=function(b_,b$){return bt.Static(function(ca){ca.setAttribute(b_,b$);});};Q.Concat=function(b_){var b$;b$=ba.ofSeqNonCopying(b_);return ba.TreeReduce(bt.EmptyAttr(),Q.Append,b$);};Q.Handler=function(b_,b$){return Q.HandlerImpl(b_,b$);};Q.Append=function(b_,b$){return bt.AppendTree(b_,b$);};Q.HandlerImpl=function(b_,b$){return bt.Static(function(ca){ca.addEventListener(b_,function(cb){return(b$(ca))(cb);},false);});};R=g.Var=b7.Class({},f,R);R.New=b7.Ctor(function(){f.New.call(this);},R);S=g.CheckedInput=b7.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,S);U=T.attr=b7.Class({},f,U);V.New=function(b_,b$,ca){return{memory:b_,position:b$,finished:ca};};W.New=function(b_,b$,ca,cb){return{opcode:b_,op1:b$,op2:ca,dest:cb};};X.SplitChars=function(b_,b$,ca){return X.Split(b_,new a.RegExp("["+X.RegexEscape(b$.join(""))+"]"),ca);};X.Trim=function(b_){return b_.replace(new a.RegExp("^\\s+"),"").replace(new a.RegExp("\\s+$"),"");};X.SplitStrings=function(b_,b$,ca){return X.Split(b_,new a.RegExp(X.concat("|",l.map(X.RegexEscape,b$))),ca);};X.Replace=function(b_,b$,ca){function cb(cc){var cd,ce,cf;cd=cc.indexOf(b$);return cd!==-1?(ce=X.ReplaceOnce(cc,b$,ca),(cf=cd+ca.length,X.Substring(ce,0,cd+ca.length)+cb(ce.substring(cf)))):cc;}return cb(b_);};X.Split=function(b_,b$,ca){return ca===1?l.filter(function(cb){return cb!=="";},X.SplitWith(b_,b$)):X.SplitWith(b_,b$);};X.RegexEscape=function(b_){return b_.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};X.concat=function(b_,b$){return l.ofSeq(b$).join(b_);};X.ReplaceOnce=function(b_,b$,ca){return b_.replace(b$,ca);};X.SplitWith=function(b_,b$){return b_.split(b$);};X.ToCharArray=function(b_){return l.init(b_.length,function(b$){return b_[b$];});};X.Substring=function(b_,b$,ca){return b_.substr(b$,ca);};X.EndsWith=function(b_,b$){return b_.substring(b_.length-b$.length)==b$;};X.StartsWith=function(b_,b$){return b_.substring(0,b$.length)==b$;};X.forall=function(b_,b$){return I.forall(b_,X.protect(b$));};X.protect=function(b_){return b_===null?"":b_;};Y.New=function(b_,b$,ca,cb){return{result:b_,xpos:b$,ypos:ca,curr_row:cb};};Z.New=function(b_,b$){return{right:b_,down:b$};};_0.max=function(b_){var b$,ca,cb;_0.nonEmpty(b_);b$=b_.$0;ca=b_.$1;while(ca.$==1){cb=ca.$0;n.Compare(cb,b$)===1?b$=cb:void 0;ca=ca.$1;}return b$;};_0.min=function(b_){var b$,ca,cb;_0.nonEmpty(b_);b$=b_.$0;ca=b_.$1;while(ca.$==1){cb=ca.$0;n.Compare(cb,b$)===-1?b$=cb:void 0;ca=ca.$1;}return b$;};_0.filter=function(b_,b$){return _0.ofSeq(I.filter(b_,b$));};_0.contains=function(b_,b$){var ca,cb;ca=false;cb=b$;while(!ca&&cb.$==1){ca=n.Equals(b_,cb.$0);cb=cb.$1;}return ca;};_0.iter=function(b_,b$){var ca;ca=b$;while(ca.$==1){b_(_0.head(ca));ca=_0.tail(ca);}};_0.head=function(b_){return b_.$==1?b_.$0:_0.listEmpty();};_0.map=function(b_,b$){var ca,cb,cc,cd,ce;if(b$.$==0)return b$;else{cd=new bd({$:1});ca=cd;cb=b$;cc=true;while(cc){ca.$0=b_(cb.$0);cb=cb.$1;cb.$==0?cc=false:ca=(ce=new bd({$:1}),ca.$1=ce,ce);}ca.$1=bd.Empty;return cd;}};_0.exists=function(b_,b$){var ca,cb;ca=false;cb=b$;while(!ca&&cb.$==1){ca=b_(cb.$0);cb=cb.$1;}return ca;};_0.forAll=function(b_,b$){var ca,cb;ca=true;cb=b$;while(ca&&cb.$==1){ca=b_(cb.$0);cb=cb.$1;}return ca;};_0.nonEmpty=function(b_){if(b_.$==0)_0.listEmpty();};_0.ofSeq=function(b_){var b$,ca,cb,cc,cd,ce;if(b_ instanceof bd)return b_;else if(b_ instanceof a.Array)return _0.ofArray(b_);else{b$=_4.Get(b_);try{cb=b$.MoveNext();if(!cb)ca=bd.Empty;else{cd=new bd({$:1});cc=cd;while(cb){cc.$0=b$.Current();b$.MoveNext()?cc=(ce=new bd({$:1}),cc.$1=ce,ce):cb=false;}cc.$1=bd.Empty;ca=cd;}return ca;}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}}};_0.listEmpty=function(){return e.FailWith("The input list was empty.");};_0.ofArray=function(b_){var b$,ca,cb;b$=bd.Empty;for(ca=l.length(b_)-1,cb=0;ca>=cb;ca--)b$=new bd({$:1,$0:l.get(b_,ca),$1:b$});return b$;};_0.tail=function(b_){return b_.$==1?b_.$1:_0.listEmpty();};_1=g.ConcreteVar=b7.Class({Set:function(b_){if(this.isConst)(function(b$){return b$("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b$){b5.log(b$);}));else{_2.Obsolete(this.snap);this.current=b_;this.snap=_2.New({$:2,$0:b_,$1:[]});}},get_View:function(){return this.view;},Get:function(){return this.current;},UpdateMaybe:function(b_){var b$;b$=b_(this.Get());b$!=null&&b$.$==1?this.Set(b$.$0):void 0;}},R,_1);_1.New=b7.Ctor(function(b_,b$,ca){var cb;cb=this;R.New.call(this);this.isConst=b_;this.current=ca;this.snap=b$;this.view=function(){return cb.snap;};this.id=bj.Int();},_1);_2.WhenRun=function(b_,b$,ca){var cb;cb=b_.s;cb==null?ca():cb!=null&&cb.$==2?(cb.$1.push(ca),b$(cb.$0)):cb!=null&&cb.$==3?(cb.$0.push(b$),cb.$1.push(ca)):b$(cb.$0);};_2.Map=function(b_,b$){var ca,cb;ca=b$.s;return ca!=null&&ca.$==0?_2.New({$:0,$0:b_(ca.$0)}):(cb=_2.New({$:3,$0:[],$1:[]}),(_2.When(b$,function(cc){_2.MarkDone(cb,b$,b_(cc));},cb),cb));};_2.Map2Unit=function(b_,b$){var ca,cb,cc;function cd(){var ce,cf,cg;if(!(ce=cc.s,ce!=null&&ce.$==0||ce!=null&&ce.$==2)){cf=_2.ValueAndForever(b_);cg=_2.ValueAndForever(b$);cf!=null&&cf.$==1?cg!=null&&cg.$==1?cf.$0[1]&&cg.$0[1]?_2.MarkForever(cc,null):_2.MarkReady(cc,null):void 0:void 0;}}ca=b_.s;cb=b$.s;return ca!=null&&ca.$==0?cb!=null&&cb.$==0?_2.New({$:0,$0:null}):b$:cb!=null&&cb.$==0?b_:(cc=_2.New({$:3,$0:[],$1:[]}),(_2.When(b_,cd,cc),_2.When(b$,cd,cc),cc));};_2.Map3=function(b_,b$,ca,cb){var cc,cd,ce,cf;function cg(ch){var ci,cj,ck,cl;if(!(ci=cf.s,ci!=null&&ci.$==0||ci!=null&&ci.$==2)){cj=_2.ValueAndForever(b$);ck=_2.ValueAndForever(ca);cl=_2.ValueAndForever(cb);cj!=null&&cj.$==1?ck!=null&&ck.$==1?cl!=null&&cl.$==1?cj.$0[1]&&ck.$0[1]&&cl.$0[1]?_2.MarkForever(cf,b_(cj.$0[0],ck.$0[0],cl.$0[0])):_2.MarkReady(cf,b_(cj.$0[0],ck.$0[0],cl.$0[0])):void 0:void 0:void 0;}}cc=b$.s;cd=ca.s;ce=cb.s;return cc!=null&&cc.$==0?cd!=null&&cd.$==0?ce!=null&&ce.$==0?_2.New({$:0,$0:b_(cc.$0,cd.$0,ce.$0)}):_2.Map3Opt1(b_,cc.$0,cd.$0,cb):ce!=null&&ce.$==0?_2.Map3Opt2(b_,cc.$0,ce.$0,ca):_2.Map3Opt3(b_,cc.$0,ca,cb):cd!=null&&cd.$==0?ce!=null&&ce.$==0?_2.Map3Opt4(b_,cd.$0,ce.$0,b$):_2.Map3Opt5(b_,cd.$0,b$,cb):ce!=null&&ce.$==0?_2.Map3Opt6(b_,ce.$0,b$,ca):(cf=_2.New({$:3,$0:[],$1:[]}),(_2.When(b$,cg,cf),_2.When(ca,cg,cf),_2.When(cb,cg,cf),cf));};_2.Sequence=function(b_){var b$,ca,cb;function cc(cd){var ce;if(cb[0]===0){ce=l.map(function(cf){var cg;cg=cf.s;return cg!=null&&cg.$==0?cg.$0:cg!=null&&cg.$==2?cg.$0:e.FailWith("value not found by View.Sequence");},b$);l.forall(function(cf){var cg;cg=cf.s;return cg!=null&&cg.$==0;},b$)?_2.MarkForever(ca,ce):_2.MarkReady(ca,ce);}else cb[0]--;}b$=l.ofSeq(b_);return b$.length==0?_2.New({$:0,$0:[]}):(ca=_2.New({$:3,$0:[],$1:[]}),(cb=[l.length(b$)-1],(l.iter(function(cd){_2.When(cd,cc,ca);},b$),ca)));};_2.Map2=function(b_,b$,ca){var cb,cc,cd;function ce(cf){var cg,ch,ci;if(!(cg=cd.s,cg!=null&&cg.$==0||cg!=null&&cg.$==2)){ch=_2.ValueAndForever(b$);ci=_2.ValueAndForever(ca);ch!=null&&ch.$==1?ci!=null&&ci.$==1?ch.$0[1]&&ci.$0[1]?_2.MarkForever(cd,b_(ch.$0[0],ci.$0[0])):_2.MarkReady(cd,b_(ch.$0[0],ci.$0[0])):void 0:void 0;}}cb=b$.s;cc=ca.s;return cb!=null&&cb.$==0?cc!=null&&cc.$==0?_2.New({$:0,$0:b_(cb.$0,cc.$0)}):_2.Map2Opt1(b_,cb.$0,ca):cc!=null&&cc.$==0?_2.Map2Opt2(b_,cc.$0,b$):(cd=_2.New({$:3,$0:[],$1:[]}),(_2.When(b$,ce,cd),_2.When(ca,ce,cd),cd));};_2.Copy=function(b_){var b$,ca,cb;b$=b_.s;return b$==null?b_:b$!=null&&b$.$==2?(ca=_2.New({$:2,$0:b$.$0,$1:[]}),(_2.WhenObsolete(b_,ca),ca)):b$!=null&&b$.$==3?(cb=_2.New({$:3,$0:[],$1:[]}),(_2.When(b_,function(cc){_2.MarkDone(cb,b_,cc);},cb),cb)):b_;};_2.WhenObsoleteRun=function(b_,b$){var ca;ca=b_.s;ca==null?b$():ca!=null&&ca.$==2?ca.$1.push(b$):ca!=null&&ca.$==3?ca.$1.push(b$):void 0;};_2.When=function(b_,b$,ca){var cb;cb=b_.s;cb==null?_2.Obsolete(ca):cb!=null&&cb.$==2?(_2.EnqueueSafe(cb.$1,ca),b$(cb.$0)):cb!=null&&cb.$==3?(cb.$0.push(b$),_2.EnqueueSafe(cb.$1,ca)):b$(cb.$0);};_2.MarkDone=function(b_,b$,ca){var cb;if(cb=b$.s,cb!=null&&cb.$==0)_2.MarkForever(b_,ca);else _2.MarkReady(b_,ca);};_2.ValueAndForever=function(b_){var b$;b$=b_.s;return b$!=null&&b$.$==0?{$:1,$0:[b$.$0,true]}:b$!=null&&b$.$==2?{$:1,$0:[b$.$0,false]}:null;};_2.MarkForever=function(b_,b$){var ca,cb,cc,cd;ca=b_.s;if(ca!=null&&ca.$==3){b_.s={$:0,$0:b$};cb=ca.$0;for(cc=0,cd=l.length(cb)-1;cc<=cd;cc++)(l.get(cb,cc))(b$);}else void 0;};_2.MarkReady=function(b_,b$){var ca,cb,cc,cd;ca=b_.s;if(ca!=null&&ca.$==3){b_.s={$:2,$0:b$,$1:ca.$1};cb=ca.$0;for(cc=0,cd=l.length(cb)-1;cc<=cd;cc++)(l.get(cb,cc))(b$);}else void 0;};_2.Map3Opt1=function(b_,b$,ca,cb){return _2.Map(function(cc){return b_(b$,ca,cc);},cb);};_2.Map3Opt2=function(b_,b$,ca,cb){return _2.Map(function(cc){return b_(b$,cc,ca);},cb);};_2.Map3Opt3=function(b_,b$,ca,cb){return _2.Map2(function(cc,cd){return b_(b$,cc,cd);},ca,cb);};_2.Map3Opt4=function(b_,b$,ca,cb){return _2.Map(function(cc){return b_(cc,b$,ca);},cb);};_2.Map3Opt5=function(b_,b$,ca,cb){return _2.Map2(function(cc,cd){return b_(cc,b$,cd);},ca,cb);};_2.Map3Opt6=function(b_,b$,ca,cb){return _2.Map2(function(cc,cd){return b_(cc,cd,b$);},ca,cb);};_2.Map2Opt1=function(b_,b$,ca){return _2.Map(function(cb){return b_(b$,cb);},ca);};_2.Map2Opt2=function(b_,b$,ca){return _2.Map(function(cb){return b_(cb,b$);},ca);};_2.WhenObsolete=function(b_,b$){var ca;ca=b_.s;ca==null?_2.Obsolete(b$):ca!=null&&ca.$==2?_2.EnqueueSafe(ca.$1,b$):ca!=null&&ca.$==3?_2.EnqueueSafe(ca.$1,b$):void 0;};_2.Join=function(b_){var b$;b$=_2.New({$:3,$0:[],$1:[]});_2.When(b_,function(ca){var cb;cb=ca();_2.When(cb,function(cc){var cd,ce;if((cd=cb.s,cd!=null&&cd.$==0)&&(ce=b_.s,ce!=null&&ce.$==0))_2.MarkForever(b$,cc);else _2.MarkReady(b$,cc);},b$);},b$);return b$;};_2.EnqueueSafe=function(b_,b$){var ca,cb,cc,cd;b_.push(b$);if(b_.length%20===0){ca=b_.slice(0);b1.Clear(b_);for(cb=0,cc=l.length(ca)-1;cb<=cc;cb++){cd=l.get(ca,cb);typeof cd=="object"?function(ce){if(ce.s)b_.push(ce);}(cd):function(ce){b_.push(ce);}(cd);}}else void 0;};_3.notPresent=function(){return e.FailWith("The given key was not present in the dictionary.");};_4.Get=function(b_){return b_ instanceof a.Array?_4.ArrayEnumerator(b_):n.Equals(typeof b_,"string")?_4.StringEnumerator(b_):b_.GetEnumerator();};_4.ArrayEnumerator=function(b_){return new _5.New(0,null,function(b$){var ca;ca=b$.s;return ca<l.length(b_)&&(b$.c=l.get(b_,ca),b$.s=ca+1,true);},void 0);};_4.StringEnumerator=function(b_){return new _5.New(0,null,function(b$){var ca;ca=b$.s;return ca<b_.length&&(b$.c=b_[ca],b$.s=ca+1,true);},void 0);};_4.Get0=function(b_){return b_ instanceof a.Array?_4.ArrayEnumerator(b_):n.Equals(typeof b_,"string")?_4.StringEnumerator(b_):"GetEnumerator0"in b_?b_.GetEnumerator0():b_.GetEnumerator();};_5=_4.T=b7.Class({MoveNext:function(){return this.n(this);},Current:function(){return this.c;},Dispose:function(){if(this.d)this.d(this);}},f,_5);_5.New=b7.Ctor(function(b_,b$,ca,cb){f.New.call(this);this.s=b_;this.c=b$;this.n=ca;this.d=cb;},_5);_6.$cctor=function(){_6.$cctor=a.ignore;_6.LoadedTemplates=new A.New$5();_6.LocalTemplatesLoaded=false;_6.GlobalHoles=new A.New$5();_6.TextHoleRE="\\${([^}]+)}";_6.RenderedFullDocTemplate=null;};_8.LinkElement=function(b_,b$){_8.InsertDoc(b_,b$,null);};_8.InsertDoc=function(b_,b$,ca){var cb;return b$!=null&&b$.$==1?_8.InsertNode(b_,b$.$0.El,ca):b$!=null&&b$.$==2?(cb=b$.$0,(cb.Dirty=false,_8.InsertDoc(b_,cb.Current,ca))):b$==null?ca:b$!=null&&b$.$==4?_8.InsertNode(b_,b$.$0.Text,ca):b$!=null&&b$.$==5?_8.InsertNode(b_,b$.$0,ca):b$!=null&&b$.$==6?l.foldBack(function(cc,cd){return cc==null||cc.constructor===P?_8.InsertDoc(b_,cc,cd):_8.InsertNode(b_,cc,cd);},b$.$0.Els,ca):_8.InsertDoc(b_,b$.$0,_8.InsertDoc(b_,b$.$1,ca));};_8.CreateRunState=function(b_,b$){return bz.New(bA.get_Empty(),_8.CreateElemNode(b_,bt.EmptyAttr(),b$));};_8.PerformAnimatedUpdate=function(b_,b$,ca){var cb;return bo.get_UseAnimations()?(cb=null,bB.Delay(function(){var cc,cd,ce;cc=bA.FindAll(ca);cd=_8.ComputeChangeAnim(b$,cc);ce=_8.ComputeEnterAnim(b$,cc);return bB.Bind(bo.Play(bo.Append(cd,_8.ComputeExitAnim(b$,cc))),function(){return bB.Bind(_8.SyncElemNodesNextFrame(b_,b$),function(){return bB.Bind(bo.Play(ce),function(){b$.PreviousNodes=cc;return bB.Return(null);});});});})):_8.SyncElemNodesNextFrame(b_,b$);};_8.PerformSyncUpdate=function(b_,b$,ca){var cb;cb=bA.FindAll(ca);_8.SyncElemNode(b_,b$.Top);b$.PreviousNodes=cb;};_8.InsertBeforeDelim=function(b_,b$){var ca,cb;ca=b_.parentNode;cb=self.document.createTextNode("");ca.insertBefore(cb,b_);_8.LinkPrevElement(b_,b$);return cb;};_8.InsertNode=function(b_,b$,ca){$.InsertAt(b_,ca,b$);return b$;};_8.CreateElemNode=function(b_,b$,ca){var cb;_8.LinkElement(b_,ca);cb=bt.Insert(b_,b$);return _9.New(cb,ca,null,b_,bj.Int(),b7.GetOptional(cb.OnAfterRender));};_8.SyncElemNodesNextFrame=function(b_,b$){function ca(cb){a.requestAnimationFrame(function(){_8.SyncElemNode(b_,b$.Top);cb();});}return bp.BatchUpdatesEnabled()?bB.FromContinuations(function(cb,cc,cd){return ca.apply(null,[cb,cc,cd]);}):(_8.SyncElemNode(b_,b$.Top),bB.Return(null));};_8.ComputeExitAnim=function(b_,b$){return bo.Concat(l.map(function(ca){return bt.GetExitAnim(ca.Attr);},bA.ToArray(bA.Except(b$,bA.Filter(function(ca){return bt.HasExitAnim(ca.Attr);},b_.PreviousNodes)))));};_8.ComputeEnterAnim=function(b_,b$){return bo.Concat(l.map(function(ca){return bt.GetEnterAnim(ca.Attr);},bA.ToArray(bA.Except(b_.PreviousNodes,bA.Filter(function(ca){return bt.HasEnterAnim(ca.Attr);},b$)))));};_8.ComputeChangeAnim=function(b_,b$){var ca;function cb(cc){return bt.HasChangeAnim(cc.Attr);}ca=function(cc){return bA.Filter(cb,cc);};return bo.Concat(l.map(function(cc){return bt.GetChangeAnim(cc.Attr);},bA.ToArray(bA.Intersect(ca(b_.PreviousNodes),ca(b$)))));};_8.SyncElemNode=function(b_,b$){!b_?_8.SyncElement(b$):void 0;_8.Sync(b$.Children);_8.AfterRender(b$);};_8.CreateEmbedNode=function(){return{Current:null,Dirty:false};};_8.UpdateEmbedNode=function(b_,b$){b_.Current=b$;b_.Dirty=true;};_8.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};_8.UpdateTextNode=function(b_,b$){b_.Value=b$;b_.Dirty=true;};_8.LinkPrevElement=function(b_,b$){_8.InsertDoc(b_.parentNode,b$,b_);};_8.SyncElement=function(b_){function b$(ca){function cb(cc){var cd,ce;return cc!=null&&cc.$==0?cb(cc.$0)||cb(cc.$1):cc!=null&&cc.$==2?(cd=cc.$0,cd.Dirty||cb(cd.Current)):cc!=null&&cc.$==6&&(ce=cc.$0,ce.Dirty||l.exists(b$,ce.Holes));}return cb(ca.Children);}bt.Sync(b_.El,b_.Attr);b$(b_)?_8.DoSyncElement(b_):void 0;};_8.Sync=function(b_){var b$,ca;if(b_!=null&&b_.$==1)_8.SyncElemNode(false,b_.$0);else if(b_!=null&&b_.$==2)_8.Sync(b_.$0.Current);else if(b_==null);else if(b_!=null&&b_.$==5);else if(b_!=null&&b_.$==4){b$=b_.$0;b$.Dirty?(b$.Text.nodeValue=b$.Value,b$.Dirty=false):void 0;}else if(b_!=null&&b_.$==6){ca=b_.$0;l.iter(function(cb){_8.SyncElemNode(false,cb);},ca.Holes);l.iter(function(cb){bt.Sync(cb[0],cb[1]);},ca.Attrs);_8.AfterRender(ca);}else{_8.Sync(b_.$0);_8.Sync(b_.$1);}};_8.AfterRender=function(b_){var b$;b$=b7.GetOptional(b_.Render);b$!=null&&b$.$==1?(b$.$0(b_.El),b7.SetOptional(b_,"Render",null)):void 0;};_8.DoSyncElement=function(b_){var b$,ca,cb;function cc(cd,ce){var cf,cg;return cd!=null&&cd.$==1?cd.$0.El:cd!=null&&cd.$==2?(cf=cd.$0,cf.Dirty?(cf.Dirty=false,_8.InsertDoc(b$,cf.Current,ce)):cc(cf.Current,ce)):cd==null?ce:cd!=null&&cd.$==4?cd.$0.Text:cd!=null&&cd.$==5?cd.$0:cd!=null&&cd.$==6?(cg=cd.$0,(cg.Dirty?cg.Dirty=false:void 0,l.foldBack(function(ch,ci){return ch==null||ch.constructor===P?cc(ch,ci):ch;},cg.Els,ce))):cc(cd.$0,cc(cd.$1,ce));}b$=b_.El;bW.Iter((ca=b_.El,function(cd){$.RemoveNode(ca,cd);}),bW.Except(bW.DocChildren(b_),bW.Children(b_.El,b7.GetOptional(b_.Delimiters))));cc(b_.Children,(cb=b7.GetOptional(b_.Delimiters),cb!=null&&cb.$==1?cb.$0[1]:null));};_9=g.DocElemNode=b7.Class({Equals:function(b_){return this.ElKey===b_.ElKey;},GetHashCode:function(){return this.ElKey;}},null,_9);_9.New=function(b_,b$,ca,cb,cc,cd){var ce;return new _9((ce={Attr:b_,Children:b$,El:cb,ElKey:cc},(b7.SetOptional(ce,"Delimiters",ca),b7.SetOptional(ce,"Render",cd),ce)));};N.Const=function(b_){var b$;b$=_2.New({$:0,$0:b_});return function(){return b$;};};N.Sink=function(b_,b$){function ca(){_2.WhenRun(b$(),b_,function(){bB.scheduler().Fork(ca);});}bB.scheduler().Fork(ca);};N.Map=function(b_,b$){return N.CreateLazy(function(){return _2.Map(b_,b$());});};N.Map2Unit=function(b_,b$){return N.CreateLazy(function(){return _2.Map2Unit(b_(),b$());});};N.Map3=function(b_,b$,ca,cb){return N.CreateLazy(function(){return _2.Map3(b_,b$(),ca(),cb());});};N.Sequence=function(b_){return N.CreateLazy(function(){return _2.Sequence(I.map(function(b$){return b$();},b_));});};N.Map2=function(b_,b$,ca){return N.CreateLazy(function(){return _2.Map2(b_,b$(),ca());});};N.Bind=function(b_,b$){return N.Join(N.Map(b_,b$));};N.CreateLazy=function(b_){var b$;b$={c:null,o:b_};return function(){var ca,cb;ca=b$.c;return ca===null?(ca=b$.o(),b$.c=ca,(cb=ca.s,cb!=null&&cb.$==0)?b$.o=null:_2.WhenObsoleteRun(ca,function(){b$.c=null;}),ca):ca;};};N.Join=function(b_){return N.CreateLazy(function(){return _2.Join(b_());});};$.ParseHTMLIntoFakeRoot=function(b_){var b$,ca,cb,cc,cd;b$=self.document.createElement("div");return!$.rhtml().test(b_)?(b$.appendChild(self.document.createTextNode(b_)),b$):(ca=(cb=$.rtagName().exec(b_),n.Equals(cb,null)?"":l.get(cb,1).toLowerCase()),(cc=(cd=($.wrapMap())[ca],cd?cd:$.defaultWrap()),(b$.innerHTML=cc[1]+b_.replace($.rxhtmlTag(),"<$1></$2>")+cc[2],function(ce,cf){var cg;while(true)if(cf===0)return ce;else{cg=cf;ce=ce.lastChild;cf=cg-1;}}(b$,cc[0]))));};$.ChildrenArray=function(b_){var b$,ca,cb;b$=[];for(ca=0,cb=b_.childNodes.length-1;ca<=cb;ca++)b$.push(b_.childNodes[ca]);return b$;};$.rhtml=function(){bJ.$cctor();return bJ.rhtml;};$.wrapMap=function(){bJ.$cctor();return bJ.wrapMap;};$.defaultWrap=function(){bJ.$cctor();return bJ.defaultWrap;};$.rxhtmlTag=function(){bJ.$cctor();return bJ.rxhtmlTag;};$.rtagName=function(){bJ.$cctor();return bJ.rtagName;};$.IterSelector=function(b_,b$,ca){var cb,cc,cd;cb=b_.querySelectorAll(b$);for(cc=0,cd=cb.length-1;cc<=cd;cc++)ca(cb[cc]);};$.InsertAt=function(b_,b$,ca){var cb;if(!(ca.parentNode===b_&&b$===(cb=ca.nextSibling,n.Equals(cb,null)?null:cb)))b_.insertBefore(ca,b$);};$.RemoveNode=function(b_,b$){if(b$.parentNode===b_)b_.removeChild(b$);};ba.ofSeqNonCopying=function(b_){var b$,ca;if(b_ instanceof a.Array)return b_;else if(b_ instanceof bd)return l.ofList(b_);else if(b_===null)return[];else{b$=[];ca=_4.Get(b_);try{while(ca.MoveNext())b$.push(ca.Current());return b$;}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}}};ba.TreeReduce=function(b_,b$,ca){var cb;function cc(cd,ce){var cf,cg;return ce<=0?b_:ce===1&&(cd>=0&&cd<cb)?l.get(ca,cd):(cg=ce/2>>0,b$(cc(cd,cg),cc(cd+cg,ce-cg)));}cb=l.length(ca);return cc(0,cb);};ba.MapTreeReduce=function(b_,b$,ca,cb){var cc;function cd(ce,cf){var cg,ch;return cf<=0?b$:cf===1&&(ce>=0&&ce<cc)?b_(l.get(cb,ce)):(ch=cf/2>>0,ca(cd(ce,ch),cd(ce+ch,cf-ch)));}cc=l.length(cb);return cd(0,cc);};I.last=function(b_){var b$,ca;b$=_4.Get(b_);try{if(!b$.MoveNext())ca=I.insufficient();else{while(b$.MoveNext());ca=b$.Current();}return ca;}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}};I.insufficient=function(){return e.FailWith("The input sequence has an insufficient number of elements.");};I.nonNegative=function(){return e.FailWith("The input must be non-negative.");};bb.$cctor=function(){bb.$cctor=a.ignore;bb.move1=Z.New(3,1);bb.start=Y.New(0,0,0,0);bb.test=l.map(C.cleanLine,X.SplitChars(X.Replace(X.Replace("..##.........##.........##.........##.........##.........##.......\r\n#..O#...#..#...#...#..#...#...#..#...#...#..#...#...#..#...#...#..\r\n.#....X..#..#....#..#..#....#..#..#....#..#..#....#..#..#....#..#.\r\n..#.#...#O#..#.#...#.#..#.#...#.#..#.#...#.#..#.#...#.#..#.#...#.#\r\n.#...##..#..X...##..#..#...##..#..#...##..#..#...##..#..#...##..#.\r\n..#.##.......#.X#.......#.##.......#.##.......#.##.......#.##.....\r\n.#.#.#....#.#.#.#.O..#.#.#.#....#.#.#.#....#.#.#.#....#.#.#.#....#\r\n.#........#.#........X.#........#.#........#.#........#.#........#\r\n#.##...#...#.##...#...#.X#...#...#.##...#...#.##...#...#.##...#...\r\n#...##....##...##....##...#X....##...##....##...##....##...##....#\r\n.#..#...#.#.#..#...#.#.#..#...X.#.#..#...#.#.#..#...#.#.#..#...#.#","O","."),"X","#"),["\n"],0));};bc.New=function(b_,b$,ca,cb,cc){return{result:b_,xpos:b$,ypos:ca,curr_row:cb,curr_list:cc};};bd=_0.T=b7.Class({GetEnumerator:function(){return new _5.New(this,null,function(b_){var b$;b$=b_.s;return b$.$==0?false:(b_.c=b$.$0,b_.s=b$.$1,true);},void 0);},GetEnumerator0:function(){return _4.Get(this);}},null,bd);bd.Empty=new bd({$:0});be.$cctor=function(){be.$cctor=a.ignore;be.txtFields="byr (Birth Year)\r\n    iyr (Issue Year)\r\n    eyr (Expiration Year)\r\n    hgt (Height)\r\n    hcl (Hair Color)\r\n    ecl (Eye Color)\r\n    pid (Passport ID)";be.fields=l.map(function(b_){return l.get(X.SplitChars(b_,[" "],0),0);},l.map(C.cleanLine,X.SplitChars(E.txtFields(),["\n"],0)));be.move1=bd.Empty;be.move2=E.move1();be.step2=b7.Curried(E.step1,6);};bg=d.MatchFailureException=b7.Class({},bf,bg);bg.New=b7.Ctor(function(b_,b$,ca){this.message=b_+" at "+a.String(b$)+":"+a.String(ca);P.setPrototypeOf(this,bg.prototype);},bg);bh.$cctor=function(){bh.$cctor=a.ignore;bh.move1=[l.ofSeq(e.range(0,127)),l.ofSeq(e.range(0,8))];bh.move2=F.move1();bh.step2=b7.Curried(function(b_,b$,ca,cb,cc,cd){return F.step1(function(ce,cf,cg,ch,ci){return((((b_(ce))(cf))(cg))(ch))(ci);},b$,ca,cb,cc,cd);},6);bh.read2=b7.Curried(F.read1,5);};bj.Int=function(){bj.set_counter(bj.counter()+1);return bj.counter();};bj.set_counter=function(b_){bH.$cctor();bH.counter=b_;};bj.counter=function(){bH.$cctor();return bH.counter;};bk=g.Elt=b7.Class({},x,bk);bk.TreeNode=function(b_,b$){var ca,cb;function cc(cd){return cd[1];}ca=bw.Create(b$);return new bk.New$1({$:6,$0:b_},N.Map2Unit((cb=l.map(function(cd){return bt.Updates(cc(cd));},b_.Attrs),ba.TreeReduce(N.Const(),N.Map2Unit,cb)),ca.v),l.get(b_.Els,0),ca);};bk.New=function(b_,b$,ca){var cb,cc;cb=_8.CreateElemNode(b_,b$,ca.docNode);cc=bw.Create(ca.updates);return new bk.New$1({$:1,$0:cb},N.Map2Unit(bt.Updates(cb.Attr),cc.v),b_,cc);};bk.New$1=b7.Ctor(function(b_,b$,ca,cb){x.New.call(this,b_,b$);this.docNode$1=b_;this.updates$1=b$;this.elt=ca;this.rvUpdates=cb;},bk);bl.convertTextNode=function(b_){var b$,ca,cb,cc,cd,ce;b$=null;ca=0;cc=b_.textContent;cd=new a.RegExp(w.TextHoleRE(),"g");while(b$=cd.exec(cc),b$!==null){b_.parentNode.insertBefore(self.document.createTextNode(bm.string(cc,{$:1,$0:ca},{$:1,$0:cd.lastIndex-l.get(b$,0).length-1})),b_);ca=cd.lastIndex;ce=self.document.createElement("span");ce.setAttribute("ws-replace",l.get(b$,1).toLowerCase());b_.parentNode.insertBefore(ce,b_);}cd.lastIndex=0;b_.textContent=bm.string(cc,{$:1,$0:ca},null);};bl.failNotLoaded=function(b_){b5.warn("Instantiating non-loaded template",b_);};bl.fillTextHole=function(b_,b$,ca){var cb;cb=b_.querySelector("[ws-replace]");return n.Equals(cb,null)?(b5.warn("Filling non-existent text hole",ca),null):(cb.parentNode.replaceChild(self.document.createTextNode(b$),cb),{$:1,$0:cb.getAttribute("ws-replace")});};bl.removeHolesExcept=function(b_,b$){function ca(cb){w.foreachNotPreserved(b_,"["+cb+"]",function(cc){if(!b$.Contains(cc.getAttribute(cb)))cc.removeAttribute(cb);});}ca("ws-attr");ca("ws-onafterrender");ca("ws-var");w.foreachNotPreserved(b_,"[ws-hole]",function(cb){if(!b$.Contains(cb.getAttribute("ws-hole"))){cb.removeAttribute("ws-hole");while(cb.hasChildNodes())cb.removeChild(cb.lastChild);}});w.foreachNotPreserved(b_,"[ws-replace]",function(cb){if(!b$.Contains(cb.getAttribute("ws-replace")))cb.parentNode.removeChild(cb);});w.foreachNotPreserved(b_,"[ws-on]",function(cb){cb.setAttribute("ws-on",X.concat(" ",l.filter(function(cc){return b$.Contains(l.get(X.SplitChars(cc,[":"],1),1));},X.SplitChars(cb.getAttribute("ws-on"),[" "],1))));});w.foreachNotPreserved(b_,"[ws-attr-holes]",function(cb){var cc,cd,ce,cf,cg;cc=X.SplitChars(cb.getAttribute("ws-attr-holes"),[" "],1);for(cd=0,ce=cc.length-1;cd<=ce;cd++){cf=l.get(cc,cd);cb.setAttribute(cf,(cg=new a.RegExp(w.TextHoleRE(),"g"),cb.getAttribute(cf).replace(cg,function(ch,ci){return b$.Contains(ci)?ch:"";})));}});};bl.fillInstanceAttrs=function(b_,b$){var ca,cb,cc,cd,ce;bl.convertAttrs(b$);ca=b$.nodeName.toLowerCase();cb=b_.querySelector("[ws-attr="+ca+"]");if(n.Equals(cb,null))b5.warn("Filling non-existent attr hole",ca);else{cb.removeAttribute("ws-attr");for(cc=0,cd=b$.attributes.length-1;cc<=cd;cc++){ce=b$.attributes.item(cc);ce.name==="class"&&cb.hasAttribute("class")?cb.setAttribute("class",cb.getAttribute("class")+" "+ce.nodeValue):cb.setAttribute(ce.name,ce.nodeValue);}}};bl.mapHoles=function(b_,b$){function ca(cb){w.foreachNotPreserved(b_,"["+cb+"]",function(cc){var cd,ce;cd=(ce=null,[b$.TryGetValue(cc.getAttribute(cb).toLowerCase(),{get:function(){return ce;},set:function(cf){ce=cf;}}),ce]);cd[0]?cc.setAttribute(cb,cd[1]):void 0;});}ca("ws-hole");ca("ws-replace");ca("ws-attr");ca("ws-onafterrender");ca("ws-var");w.foreachNotPreserved(b_,"[ws-on]",function(cb){cb.setAttribute("ws-on",X.concat(" ",l.map(function(cc){var cd,ce,cf;cd=X.SplitChars(cc,[":"],1);ce=(cf=null,[b$.TryGetValue(l.get(cd,1),{get:function(){return cf;},set:function(cg){cf=cg;}}),cf]);return ce[0]?l.get(cd,0)+":"+ce[1]:cc;},X.SplitChars(cb.getAttribute("ws-on"),[" "],1))));});w.foreachNotPreserved(b_,"[ws-attr-holes]",function(cb){var cc,cd,ce;cc=X.SplitChars(cb.getAttribute("ws-attr-holes"),[" "],1);for(cd=0,ce=cc.length-1;cd<=ce;cd++)(function(){var cf;function cg(ch,ci){var cj;cj=e.KeyValue(ci);return ch.replace(new a.RegExp("\\${"+cj[0]+"}","ig"),"${"+cj[1]+"}");}cf=l.get(cc,cd);return cb.setAttribute(cf,(((b7.Curried3(I.fold))(cg))(cb.getAttribute(cf)))(b$));}());});};bl.fill=function(b_,b$,ca){while(true)if(b_.hasChildNodes())ca=b$.insertBefore(b_.lastChild,ca);else return null;};bl.convertAttrs=function(b_){var ca,cb,cc,cd,ce,cf,cg,ch;function b$(ci){var cj;cj=b_.getAttribute(ci);cj===null?void 0:b_.setAttribute(ci,cj.toLowerCase());}ca=b_.attributes;cb=[];cc=[];cd=[];for(ce=0,cf=ca.length-1;ce<=cf;ce++){cg=ca.item(ce);X.StartsWith(cg.nodeName,"ws-on")&&cg.nodeName!=="ws-onafterrender"&&cg.nodeName!=="ws-on"?(cb.push(cg.nodeName),cc.push(bm.string(cg.nodeName,{$:1,$0:"ws-on".length},null)+":"+cg.nodeValue.toLowerCase())):!X.StartsWith(cg.nodeName,"ws-")&&(new a.RegExp(w.TextHoleRE())).test(cg.nodeValue)?(cg.nodeValue=(ch=new a.RegExp(w.TextHoleRE(),"g"),cg.nodeValue.replace(ch,function(ci,cj){return"${"+cj.toLowerCase()+"}";})),cd.push(cg.nodeName)):void 0;}!(cc.length==0)?b_.setAttribute("ws-on",X.concat(" ",cc)):void 0;!(cd.length==0)?b_.setAttribute("ws-attr-holes",X.concat(" ",cd)):void 0;b$("ws-hole");b$("ws-replace");b$("ws-attr");b$("ws-onafterrender");b$("ws-var");l.iter(function(ci){b_.removeAttribute(ci);},cb);};bm.string=function(b_,b$,ca){return b$==null?ca!=null&&ca.$==1?b_.slice(0,ca.$0+1):"":ca==null?b_.slice(b$.$0):b_.slice(b$.$0,ca.$0+1);};bn=s.KeyCollection=b7.Class({GetEnumerator$1:function(){return _4.Get(I.map(function(b_){return b_.K;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},f,bn);bn.New=b7.Ctor(function(b_){f.New.call(this);this.d=b_;},bn);bo.get_UseAnimations=function(){return bC.UseAnimations();};bo.Play=function(b_){var b$;b$=null;return bB.Delay(function(){return bB.Bind(bo.Run(a.ignore,bC.Actions(b_)),function(){bC.Finalize(b_);return bB.Return(null);});});};bo.Append=function(b_,b$){return{$:0,$0:bL.Append(b_.$0,b$.$0)};};bo.Run=function(b_,b$){var ca;function cb(cc){function cd(ce,cf){var cg;cg=cf-ce;b$.Compute(cg);b_();return cg<=ca?void a.requestAnimationFrame(function(ch){cd(ce,ch);}):cc();}a.requestAnimationFrame(function(ce){cd(ce,ce);});}ca=b$.Duration;return ca===0?bB.Zero():bB.FromContinuations(function(cc,cd,ce){return cb.apply(null,[cc,cd,ce]);});};bo.Concat=function(b_){return{$:0,$0:bL.Concat(I.map(bC.List,b_))};};bo.get_Empty=function(){return{$:0,$0:bL.Empty()};};bp.BatchUpdatesEnabled=function(){bD.$cctor();return bD.BatchUpdatesEnabled;};bq.StartProcessor=function(b_){var b$;function ca(){var cb;cb=null;return bB.Delay(function(){return bB.Bind(b_,function(){var cc;cc=b$[0];return cc===1?(b$[0]=0,bB.Zero()):cc===2?(b$[0]=1,ca()):bB.Zero();});});}b$=[0];return function(){var cb;cb=b$[0];cb===0?(b$[0]=1,bB.Start(ca(),null)):cb===1?b$[0]=2:void 0;};};bs.New=function(b_,b$,ca,cb){var cc;cc={DynElem:b_,DynFlags:b$,DynNodes:ca};b7.SetOptional(cc,"OnAfterRender",cb);return cc;};bt.Static=function(b_){return new Q({$:3,$0:b_});};bt.Insert=function(b_,b$){var ca,cb,cc;function cd(ce){if(!(ce===null))if(ce!=null&&ce.$==1)ca.push(ce.$0);else if(ce!=null&&ce.$==2){cd(ce.$0);cd(ce.$1);}else if(ce!=null&&ce.$==3)ce.$0(b_);else if(ce!=null&&ce.$==4)cb.push(ce.$0);}ca=[];cb=[];cd(b$);cc=ca.slice(0);return bs.New(b_,bt.Flags(b$),cc,cb.length===0?null:{$:1,$0:function(ce){I.iter(function(cf){cf(ce);},cb);}});};bt.Updates=function(b_){return ba.MapTreeReduce(function(b$){return b$.NChanged();},N.Const(),N.Map2Unit,b_.DynNodes);};bt.Empty=function(b_){return bs.New(b_,0,[],null);};bt.Flags=function(b_){return b_!==null&&b_.hasOwnProperty("flags")?b_.flags:0;};bt.Dynamic=function(b_,b$){return new Q({$:1,$0:new bN.New(b_,b$)});};bt.EmptyAttr=function(){bM.$cctor();return bM.EmptyAttr;};bt.HasExitAnim=function(b_){var b$;b$=2;return(b_.DynFlags&b$)===b$;};bt.GetExitAnim=function(b_){return bt.GetAnim(b_,function(b$,ca){return b$.NGetExitAnim(ca);});};bt.HasEnterAnim=function(b_){var b$;b$=1;return(b_.DynFlags&b$)===b$;};bt.GetEnterAnim=function(b_){return bt.GetAnim(b_,function(b$,ca){return b$.NGetEnterAnim(ca);});};bt.HasChangeAnim=function(b_){var b$;b$=4;return(b_.DynFlags&b$)===b$;};bt.GetChangeAnim=function(b_){return bt.GetAnim(b_,function(b$,ca){return b$.NGetChangeAnim(ca);});};bt.AppendTree=function(b_,b$){var ca;return b_===null?b$:b$===null?b_:(ca=new Q({$:2,$0:b_,$1:b$}),(bt.SetFlags(ca,bt.Flags(b_)|bt.Flags(b$)),ca));};bt.GetAnim=function(b_,b$){return bo.Concat(l.map(function(ca){return b$(ca,b_.DynElem);},b_.DynNodes));};bt.Sync=function(b_,b$){l.iter(function(ca){ca.NSync(b_);},b$.DynNodes);};bt.SetFlags=function(b_,b$){b_.flags=b$;};O.Parse=function(b_,b$,ca,cb){var cc;cc=+b_;if(cc!==cc-cc%1)throw new bF.New$1("Input string was not in a correct format.");else if(cc<b$||cc>ca)throw new bG.New$1(cb);else return cc;};O.TryParse=function(b_,b$,ca,cb){var cc,cd;cc=+b_;cd=cc===cc-cc%1&&cc>=b$&&cc<=ca;cd?cb.set(cc):void 0;return cd;};bu.$cctor=function(){bu.$cctor=a.ignore;bu.start=bc.New(0,0,0,0,bd.Empty);};_2.Obsolete=function(b_){var b$,ca,cb,cc,cd;ca=b_.s;if(ca==null||(ca!=null&&ca.$==2?(b$=ca.$1,false):ca!=null&&ca.$==3?(b$=ca.$1,false):true))void 0;else{b_.s=null;for(cb=0,cc=l.length(b$)-1;cb<=cc;cb++){cd=l.get(b$,cb);typeof cd=="object"?function(ce){_2.Obsolete(ce);}(cd):cd();}}};_2.New=function(b_){return{s:b_};};bv.Handler=function(b_,b$){return bt.Static(function(ca){ca.addEventListener(b_,function(cb){return(b$(ca))(cb);},false);});};bv.OnAfterRender=function(b_){return new Q({$:4,$0:b_});};bv.Value=function(b_){var b$;b$=(((bI.StringApply())(b_))(bt.Static))(function(ca){return bv.DynamicCustom(ca,b_.get_View());});return Q.Append(b$[0],b$[1]);};bv.Checked=function(b_){var b$;b$=(((bI.BoolCheckedApply())(b_))(bt.Static))(function(ca){return bv.DynamicCustom(ca,b_.get_View());});return Q.Append(b$[0],b$[1]);};bv.IntValue=function(b_){var b$;b$=(((bI.IntApplyChecked())(b_))(bt.Static))(function(ca){return bv.DynamicCustom(ca,b_.get_View());});return Q.Append(b$[0],b$[1]);};bv.IntValueUnchecked=function(b_){var b$;b$=(((bI.IntApplyUnchecked())(b_))(bt.Static))(function(ca){return bv.DynamicCustom(ca,b_.get_View());});return Q.Append(b$[0],b$[1]);};bv.FloatValue=function(b_){var b$;b$=(((bI.FloatApplyChecked())(b_))(bt.Static))(function(ca){return bv.DynamicCustom(ca,b_.get_View());});return Q.Append(b$[0],b$[1]);};bv.FloatValueUnchecked=function(b_){var b$;b$=(((bI.FloatApplyUnchecked())(b_))(bt.Static))(function(ca){return bv.DynamicCustom(ca,b_.get_View());});return Q.Append(b$[0],b$[1]);};bv.Dynamic=function(b_,b$){return bt.Dynamic(b$,function(ca){return function(cb){return ca.setAttribute(b_,cb);};});};bv.DynamicCustom=function(b_,b$){return bt.Dynamic(b$,b_);};bw=g.Updates=b7.Class({},null,bw);bw.Create=function(b_){var b$;b$=null;b$=bw.New(b_,null,function(){var ca;ca=b$.s;return ca===null?(ca=_2.Copy(b$.c()),b$.s=ca,_2.WhenObsoleteRun(ca,function(){b$.s=null;}),ca):ca;});return b$;};bw.New=function(b_,b$,ca){return new bw({c:b_,s:b$,v:ca});};bx=s.ValueCollection=b7.Class({GetEnumerator$1:function(){return _4.Get(I.map(function(b_){return b_.V;},this.d));},GetEnumerator:function(){return this.GetEnumerator$1();},GetEnumerator0:function(){return this.GetEnumerator$1();}},f,bx);bx.New=b7.Ctor(function(b_){f.New.call(this);this.d=b_;},bx);bz.New=function(b_,b$){return{PreviousNodes:b_,Top:b$};};bA.get_Empty=function(){return{$:0,$0:new H.New$3()};};bA.FindAll=function(b_){var b$;function ca(cc){if(cc!=null&&cc.$==0){ca(cc.$0);ca(cc.$1);}else if(cc!=null&&cc.$==1)cb(cc.$0);else if(cc!=null&&cc.$==2)ca(cc.$0.Current);else if(cc!=null&&cc.$==6)l.iter(cb,cc.$0.Holes);}function cb(cc){b$.push(cc);ca(cc.Children);}b$=[];ca(b_);return{$:0,$0:new H.New$2(b$)};};bA.Filter=function(b_,b$){return{$:0,$0:bT.Filter(b_,b$.$0)};};bA.Except=function(b_,b$){return{$:0,$0:bT.Except(b_.$0,b$.$0)};};bA.ToArray=function(b_){return bT.ToArray(b_.$0);};bA.Intersect=function(b_,b$){return{$:0,$0:bT.Intersect(b_.$0,b$.$0)};};bB.Delay=function(b_){return function(b$){try{(b_(null))(b$);}catch(ca){b$.k({$:1,$0:ca});}};};bB.Bind=function(b_,b$){return bB.checkCancel(function(ca){b_(bQ.New(function(cb){var cc;if(cb.$==0){cc=cb.$0;bB.scheduler().Fork(function(){try{(b$(cc))(ca);}catch(cd){ca.k({$:1,$0:cd});}});}else bB.scheduler().Fork(function(){ca.k(cb);});},ca.ct));});};bB.Zero=function(){bR.$cctor();return bR.Zero;};bB.Start=function(b_,b$){var ca,cb;ca=(cb=(bB.defCTS())[0],b$==null?cb:b$.$0);bB.scheduler().Fork(function(){if(!ca.c)b_(bQ.New(function(cc){if(cc.$==1)bB.UncaughtAsyncError(cc.$0);},ca));});};bB.Return=function(b_){return function(b$){b$.k({$:0,$0:b_});};};bB.scheduler=function(){bR.$cctor();return bR.scheduler;};bB.checkCancel=function(b_){return function(b$){if(b$.ct.c)bB.cancel(b$);else b_(b$);};};bB.defCTS=function(){bR.$cctor();return bR.defCTS;};bB.UncaughtAsyncError=function(b_){b5.log("WebSharper: Uncaught asynchronous exception",b_);};bB.FromContinuations=function(b_){return function(b$){var ca;function cb(cc){if(ca[0])e.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{ca[0]=true;bB.scheduler().Fork(cc);}}ca=[false];b_(function(cc){cb(function(){b$.k({$:0,$0:cc});});},function(cc){cb(function(){b$.k({$:1,$0:cc});});},function(cc){cb(function(){b$.k({$:2,$0:cc});});});};};bB.cancel=function(b_){b_.k({$:2,$0:new bY.New(b_.ct)});};bC.UseAnimations=function(){bK.$cctor();return bK.UseAnimations;};bC.Actions=function(b_){return bC.ConcatActions(l.choose(function(b$){return b$.$==1?{$:1,$0:b$.$0}:null;},bL.ToArray(b_.$0)));};bC.Finalize=function(b_){l.iter(function(b$){if(b$.$==0)b$.$0();},bL.ToArray(b_.$0));};bC.ConcatActions=function(b_){var b$,ca,cb,cc;b$=ba.ofSeqNonCopying(b_);ca=l.length(b$);return ca===0?bC.Const():ca===1?l.get(b$,0):(cb=I.max(I.map(function(cd){return cd.Duration;},b$)),(cc=l.map(function(cd){return bC.Prolong(cb,cd);},b$),bC.Def(cb,function(cd){l.iter(function(ce){ce.Compute(cd);},cc);})));};bC.List=function(b_){return b_.$0;};bC.Const=function(b_){return bC.Def(0,function(){return b_;});};bC.Def=function(b_,b$){return{Compute:b$,Duration:b_};};bC.Prolong=function(b_,b$){var ca,cb,cc;ca=b$.Compute;cb=b$.Duration;cc=bZ.Create(function(){return b$.Compute(b$.Duration);});return{Compute:function(cd){return cd>=cb?cc.f():ca(cd);},Duration:b_};};bD.$cctor=function(){bD.$cctor=a.ignore;bD.BatchUpdatesEnabled=true;};bE.concat=function(b_){var b$,ca;b$=[];for(var cb in b_)b$.push.apply(b$,b_[cb]);return b$;};bF=d.FormatException=b7.Class({},bf,bF);bF.New$1=b7.Ctor(function(b_){this.message=b_;P.setPrototypeOf(this,bF.prototype);},bF);bG=d.OverflowException=b7.Class({},bf,bG);bG.New$1=b7.Ctor(function(b_){this.message=b_;P.setPrototypeOf(this,bG.prototype);},bG);bH.$cctor=function(){bH.$cctor=a.ignore;bH.counter=0;};bI.StringApply=function(){bM.$cctor();return bM.StringApply;};bI.BoolCheckedApply=function(){bM.$cctor();return bM.BoolCheckedApply;};bI.IntApplyChecked=function(){bM.$cctor();return bM.IntApplyChecked;};bI.IntApplyUnchecked=function(){bM.$cctor();return bM.IntApplyUnchecked;};bI.FloatApplyChecked=function(){bM.$cctor();return bM.FloatApplyChecked;};bI.FloatApplyUnchecked=function(){bM.$cctor();return bM.FloatApplyUnchecked;};bI.ApplyValue=function(b_,b$,ca,cb,cc){return[cb(function(cd){function ce(){ca.UpdateMaybe(function(cf){var cg,ch;cg=b_(cd);return cg!=null&&cg.$==1&&(!n.Equals(cg.$0,cf)&&(ch=[cg,cg.$0],true))?ch[0]:null;});}cd.addEventListener("change",ce);cd.addEventListener("input",ce);cd.addEventListener("keypress",ce);}),cc(function(cd){return function(ce){var cf,cg;cf=b_(cd);return cf!=null&&cf.$==1&&(n.Equals(cf.$0,ce)&&(cg=cf.$0,true))?null:b$(cd,ce);};})];};bI.StringSet=function(){bM.$cctor();return bM.StringSet;};bI.StringGet=function(){bM.$cctor();return bM.StringGet;};bI.IntSetUnchecked=function(){bM.$cctor();return bM.IntSetUnchecked;};bI.IntGetUnchecked=function(){bM.$cctor();return bM.IntGetUnchecked;};bI.IntSetChecked=function(){bM.$cctor();return bM.IntSetChecked;};bI.IntGetChecked=function(){bM.$cctor();return bM.IntGetChecked;};bI.FloatSetUnchecked=function(){bM.$cctor();return bM.FloatSetUnchecked;};bI.FloatGetUnchecked=function(){bM.$cctor();return bM.FloatGetUnchecked;};bI.FloatSetChecked=function(){bM.$cctor();return bM.FloatSetChecked;};bI.FloatGetChecked=function(){bM.$cctor();return bM.FloatGetChecked;};bJ.$cctor=function(){var b_;bJ.$cctor=a.ignore;bJ.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bJ.rtagName=new a.RegExp("<([\\w:]+)");bJ.rhtml=new a.RegExp("<|&#?\\w+;");bJ.wrapMap=(b_=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:b_,tbody:b_,tfoot:b_,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bJ.defaultWrap=[0,"",""];};bK.$cctor=function(){bK.$cctor=a.ignore;bK.CubicInOut=bP.Custom(function(b_){var b$;b$=b_*b_;return 3*b$-2*(b$*b_);});bK.UseAnimations=true;};bL.Append=function(b_,b$){return b_.$==0?b$:b$.$==0?b_:{$:2,$0:b_,$1:b$};};bL.ToArray=function(b_){var b$;function ca(cb){if(cb.$==1)b$.push(cb.$0);else if(cb.$==2){ca(cb.$0);ca(cb.$1);}else if(cb.$==3)l.iter(function(cc){b$.push(cc);},cb.$0);}b$=[];ca(b_);return b$.slice(0);};bL.Concat=function(b_){var b$;b$=ba.ofSeqNonCopying(b_);return ba.TreeReduce(bL.Empty(),bL.Append,b$);};bL.Empty=function(){b0.$cctor();return b0.Empty;};bM.$cctor=function(){var b_,b$,ca,cb,cc,cd,ce,cf,cg,ch;bM.$cctor=a.ignore;bM.EmptyAttr=null;bM.BoolCheckedApply=b7.Curried3(function(ci,cj,ck){return[cj(function(cl){cl.addEventListener("change",function(){return!n.Equals(ci.Get(),cl.checked)?ci.Set(cl.checked):null;});}),ck(function(cl){return function(cm){cl.checked=cm;};})];});bM.StringSet=function(ci){return function(cj){ci.value=cj;};};bM.StringGet=function(ci){return{$:1,$0:ci.value};};bM.StringApply=(b_=bI.StringGet(),(b$=bI.StringSet(),b7.Curried(bI.ApplyValue,3,[b_,function(ci,cj){return(b$(ci))(cj);}])));bM.IntSetUnchecked=function(ci){return function(cj){ci.value=a.String(cj);};};bM.IntGetUnchecked=function(ci){var cj,ck;cj=ci.value;return bU.isBlank(cj)?{$:1,$0:0}:(ck=+cj,ck!==ck>>0?null:{$:1,$0:ck});};bM.IntApplyUnchecked=(ca=bI.IntGetUnchecked(),(cb=bI.IntSetUnchecked(),b7.Curried(bI.ApplyValue,3,[ca,function(ci,cj){return(cb(ci))(cj);}])));bM.IntSetChecked=function(ci){return function(cj){var ck;ck=cj.get_Input();return ci.value!==ck?void(ci.value=ck):null;};};bM.IntGetChecked=function(ci){var cj,ck,cl;cj=ci.value;return{$:1,$0:bU.isBlank(cj)?(ci.checkValidity?ci.checkValidity():true)?new S({$:2,$0:cj}):new S({$:1,$0:cj}):(ck=(cl=0,[O.TryParseInt32(cj,{get:function(){return cl;},set:function(cm){cl=cm;}}),cl]),ck[0]?new S({$:0,$0:ck[1],$1:cj}):new S({$:1,$0:cj}))};};bM.IntApplyChecked=(cc=bI.IntGetChecked(),(cd=bI.IntSetChecked(),b7.Curried(bI.ApplyValue,3,[cc,function(ci,cj){return(cd(ci))(cj);}])));bM.FloatSetUnchecked=function(ci){return function(cj){ci.value=a.String(cj);};};bM.FloatGetUnchecked=function(ci){var cj,ck;cj=ci.value;return bU.isBlank(cj)?{$:1,$0:0}:(ck=+cj,a.isNaN(ck)?null:{$:1,$0:ck});};bM.FloatApplyUnchecked=(ce=bI.FloatGetUnchecked(),(cf=bI.FloatSetUnchecked(),b7.Curried(bI.ApplyValue,3,[ce,function(ci,cj){return(cf(ci))(cj);}])));bM.FloatSetChecked=function(ci){return function(cj){var ck;ck=cj.get_Input();return ci.value!==ck?void(ci.value=ck):null;};};bM.FloatGetChecked=function(ci){var cj,ck;cj=ci.value;return{$:1,$0:bU.isBlank(cj)?(ci.checkValidity?ci.checkValidity():true)?new S({$:2,$0:cj}):new S({$:1,$0:cj}):(ck=+cj,a.isNaN(ck)?new S({$:1,$0:cj}):new S({$:0,$0:ck,$1:cj}))};};bM.FloatApplyChecked=(cg=bI.FloatGetChecked(),(ch=bI.FloatSetChecked(),b7.Curried(bI.ApplyValue,3,[cg,function(ci,cj){return(ch(ci))(cj);}])));};bN=g.DynamicAttrNode=b7.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(b_){return bo.get_Empty();},NGetEnterAnim:function(b_){return bo.get_Empty();},NGetChangeAnim:function(b_){return bo.get_Empty();},NSync:function(b_){if(this.dirty){(this.push(b_))(this.value);this.dirty=false;}}},f,bN);bN.New=b7.Ctor(function(b_,b$){var ca;ca=this;f.New.call(this);this.push=b$;this.value=void 0;this.dirty=false;this.updates=N.Map(function(cb){ca.value=cb;ca.dirty=true;},b_);},bN);bO=bB.Scheduler=b7.Class({Fork:function(b_){var b$;b$=this;this.robin.push(b_);this.idle?(this.idle=false,a.setTimeout(function(){b$.tick();},0)):void 0;},tick:function(){var b_,b$,ca;b$=this;ca=b9.now();b_=true;while(b_)if(this.robin.length===0){this.idle=true;b_=false;}else{(this.robin.shift())();b9.now()-ca>40?(a.setTimeout(function(){b$.tick();},0),b_=false):void 0;}}},f,bO);bO.New=b7.Ctor(function(){f.New.call(this);this.idle=true;this.robin=[];},bO);bP=g.Easing=b7.Class({},f,bP);bP.Custom=function(b_){return new bP.New(b_);};bP.New=b7.Ctor(function(b_){f.New.call(this);this.transformTime=b_;},bP);bQ.New=function(b_,b$){return{k:b_,ct:b$};};bR.$cctor=function(){bR.$cctor=a.ignore;bR.noneCT=bS.New(false,[]);bR.scheduler=new bO.New();bR.defCTS=[new bV.New()];bR.Zero=bB.Return();bR.GetCT=function(b_){b_.k({$:0,$0:b_.ct});};};bS.New=function(b_,b$){return{c:b_,r:b$};};bT.Filter=function(b_,b$){return new H.New$2(l.filter(b_,bT.ToArray(b$)));};bT.Except=function(b_,b$){var ca;ca=new H.New$2(bT.ToArray(b$));ca.ExceptWith(bT.ToArray(b_));return ca;};bT.ToArray=function(b_){var b$;b$=l.create(b_.get_Count(),void 0);b_.CopyTo(b$);return b$;};bT.Intersect=function(b_,b$){var ca;ca=new H.New$2(bT.ToArray(b_));ca.IntersectWith(bT.ToArray(b$));return ca;};bU.isBlank=function(b_){return X.forall(bX.IsWhiteSpace,b_);};bV=d.CancellationTokenSource=b7.Class({},f,bV);bV.New=b7.Ctor(function(){f.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bV);bW.Children=function(b_,b$){var ca,cb,cc;if(b$!=null&&b$.$==1){cc=[];ca=b$.$0[0].nextSibling;while(ca!==b$.$0[1]){cc.push(ca);ca=ca.nextSibling;}return{$:0,$0:cc};}else return{$:0,$0:l.init(b_.childNodes.length,(cb=b_.childNodes,function(cd){return cb[cd];}))};};bW.Except=function(b_,b$){var ca;ca=b_.$0;return{$:0,$0:l.filter(function(cb){return l.forall(function(cc){return!(cb===cc);},ca);},b$.$0)};};bW.Iter=function(b_,b$){l.iter(b_,b$.$0);};bW.DocChildren=function(b_){var b$;function ca(cb){if(cb!=null&&cb.$==2)ca(cb.$0.Current);else if(cb!=null&&cb.$==1)b$.push(cb.$0.El);else if(cb==null);else if(cb!=null&&cb.$==5)b$.push(cb.$0);else if(cb!=null&&cb.$==4)b$.push(cb.$0.Text);else if(cb!=null&&cb.$==6)l.iter(function(cc){if(cc==null||cc.constructor===P)ca(cc);else b$.push(cc);},cb.$0.Els);else{ca(cb.$0);ca(cb.$1);}}b$=[];ca(b_.Children);return{$:0,$0:ba.ofSeqNonCopying(b$)};};bX.IsWhiteSpace=function(b_){return b_.match(new a.RegExp("\\s"))!==null;};bY=d.OperationCanceledException=b7.Class({},bf,bY);bY.New=b7.Ctor(function(b_){bY.New$1.call(this,"The operation was canceled.",null,b_);},bY);bY.New$1=b7.Ctor(function(b_,b$,ca){this.message=b_;this.inner=b$;P.setPrototypeOf(this,bY.prototype);this.ct=ca;},bY);bZ.Create=function(b_){return b3.New(false,b_,bZ.forceLazy);};bZ.forceLazy=function(){var b_;b_=this.v();this.c=true;this.v=b_;this.f=bZ.cachedLazy;return b_;};bZ.cachedLazy=function(){return this.v;};b0.$cctor=function(){b0.$cctor=a.ignore;b0.Empty={$:0};};b1.Clear=function(b_){b_.splice(0,l.length(b_));};b3.New=function(b_,b$,ca){return{c:b_,v:b$,f:ca};};b7.OnLoad(function(){c.Main();});}());


if (typeof IntelliFactory !=='undefined') {
  IntelliFactory.Runtime.ScriptBasePath = '/Content/';
  IntelliFactory.Runtime.Start();
}
